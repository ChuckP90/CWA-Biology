<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CWA Secondary Biology</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    body {
      background: #e8f5e8;
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect, useRef, useCallback } = React;

    function App() {
      const [currentPage, setCurrentPage] = useState("home");
      const [currentLanguage, setCurrentLanguage] = useState("en");
      const [isAuthenticated, setIsAuthenticated] = useState(false);
      const [activeAdminTab, setActiveAdminTab] = useState("units");
      const [navigationHistory, setNavigationHistory] = useState(["home"]);
      const [user, setUser] = useState(null);
      
      // Initialize with empty users array - no pre-existing accounts
      const [users, setUsers] = useState([]);
      
      // Create refs for all input fields to maintain focus
      const loginUsernameRef = useRef(null);
      const loginPasswordRef = useRef(null);
      const signupNameRef = useRef(null);
      const signupEmailRef = useRef(null);
      const signupUsernameRef = useRef(null);
      const signupPasswordRef = useRef(null);
      const signupConfirmPasswordRef = useRef(null);
      const signupClassRef = useRef(null);
      const adminCodeRef = useRef(null);

      // Form state
      const [loginForm, setLoginForm] = useState({
        username: "",
        password: ""
      });
      
      const [signupForm, setSignupForm] = useState({
        name: "",
        email: "",
        username: "",
        password: "",
        confirmPassword: "",
        role: "student",
        class: ""
      });
      
      const [signupStep, setSignupStep] = useState(1); // 1: form, 2: verification
      const [verificationCode, setVerificationCode] = useState("");
      const [isVerifying, setIsVerifying] = useState(false);

      // Master admin configuration
      const ADMIN_CONFIG = {
        secretCode: "CWA2024BIO",
        accessLevels: {
          FULL_ACCESS: "full",
          CONTENT_ONLY: "content",
          VIEW_ONLY: "view"
        }
      };

      // Admin access state
      const [showAdminPrompt, setShowAdminPrompt] = useState(false);
      const [adminCode, setAdminCode] = useState("");

      // Initial content data
      const [content, setContent] = useState([
        {
          unit: "Unit 1.1",
          title: "Characteristics of Living Organisms",
          articles: [
            { 
              id: 1, 
              title: "Introduction to Biology", 
              level: "Beginner", 
              content: "All living organisms share certain characteristics that distinguish them from non-living things. These include nutrition, respiration, movement, excretion, growth, reproduction, and sensitivity.",
              lastUpdated: "2024-01-15"
            }
          ],
          exercises: [
            { 
              id: 1, 
              question: "What are the seven characteristics of living organisms?", 
              type: "short-answer",
              difficulty: "easy",
              points: 5
            }
          ],
          videos: [
            { 
              id: 1, 
              title: "Introduction to Cells", 
              url: "https://placehold.co/400x225?text=Video:+Introduction+to+Cells", 
              duration: "5:30",
              thumbnail: "https://placehold.co/400x225?text=Cell+Video",
              description: "Basic introduction to cell structure and function"
            }
          ]
        },
        {
          unit: "Unit 1.2",
          title: "Testing Predictions",
          articles: [
            { 
              id: 1, 
              title: "Scientific Method Basics", 
              level: "Beginner", 
              content: "The scientific method involves making observations, forming hypotheses, conducting experiments, and drawing conclusions. This systematic approach helps scientists investigate natural phenomena.",
              lastUpdated: "2024-01-12"
            }
          ],
          exercises: [
            { 
              id: 1, 
              question: "List the steps of the scientific method in order.", 
              type: "short-answer",
              difficulty: "easy",
              points: 5
            }
          ],
          videos: [
            { 
              id: 1, 
              title: "Scientific Method Explained", 
              url: "https://placehold.co/400x225?text=Video:+Scientific+Method", 
              duration: "7:15",
              thumbnail: "https://placehold.co/400x225?text=Scientific+Method",
              description: "Step-by-step guide to the scientific method"
            }
          ]
        }
      ]);

      const [assignments] = useState([
        {
          id: 1,
          title: "Cell Structure Assignment",
          description: "Draw and label a detailed diagram of an animal cell and a plant cell.",
          dueDate: "2024-01-15",
          unit: "Unit 2.1",
          status: "pending",
          points: 20
        }
      ]);

      const [quizzes] = useState([
        {
          id: 1,
          title: "Quiz 1: Characteristics of Living Organisms",
          unit: "Unit 1.1",
          timeLimit: 15,
          totalPoints: 15,
          questions: [
            { 
              id: 1,
              question: "Which of the following is NOT a characteristic of living organisms?", 
              options: ["Nutrition", "Respiration", "Photosynthesis", "Excretion"], 
              answer: 2,
              points: 3,
              explanation: "Photosynthesis is a process performed by plants and some bacteria, but not all living organisms."
            }
          ],
        }
      ]);

      // Language translations
      const translations = {
        en: {
          title: "CWA Secondary Biology",
          home: "Home",
          library: "Library",
          exercises: "Exercises",
          assignments: "Assignments",
          progress: "Progress",
          admin: "Admin",
          welcome: "Welcome to CWA Secondary Biology",
          adminAccess: "Admin Access",
          enterCode: "Enter Admin Code:",
          accessGranted: "Access Granted!",
          invalidCode: "Invalid code. Please try again.",
          logout: "Logout",
          unitManagement: "Unit Management",
          addUnit: "Add Unit",
          editUnit: "Edit Unit",
          deleteUnit: "Delete Unit",
          unitCode: "Unit Code:",
          unitTitle: "Unit Title:",
          description: "Description:",
          units: "Units",
          content: "Content",
          exercises: "Exercises",
          videos: "Videos",
          manageUnits: "Manage Units",
          createUnit: "Create Unit",
          confirmUnitDelete: "Are you sure you want to delete this unit? This will also remove all associated content, assignments, and quizzes.",
          back: "Back",
          home: "Home",
          language: "Language",
          english: "English",
          chinese: "中文",
          login: "Login",
          register: "Register",
          signup: "Sign Up",
          username: "Username",
          password: "Password",
          confirmPassword: "Confirm Password",
          email: "Email",
          name: "Name",
          class: "Class",
          role: "Role",
          student: "Student",
          teacher: "Teacher",
          loginToContinue: "Please login to continue",
          myProgress: "My Progress",
          completedUnits: "Completed Units:",
          quizAverage: "Quiz Average:",
          assignmentsCompleted: "Assignments Completed:",
          lastActive: "Last Active:",
          studentDashboard: "Student Dashboard",
          teacherDashboard: "Teacher Dashboard",
          manageStudents: "Manage Students",
          createAssignment: "Create Assignment",
          viewProgress: "View Progress",
          welcomeBack: "Welcome back",
          account: "Account",
          profile: "Profile",
          settings: "Settings",
          next: "Next",
          verifyEmail: "Verify Email",
          verificationCode: "Verification Code",
          resendCode: "Resend Code",
          emailVerification: "Email Verification",
          verificationSent: "A verification code has been sent to your email. Please check your inbox.",
          verify: "Verify",
          emailSent: "Verification email sent!",
          codeSent: "A 6-digit code has been sent to",
          pleaseCheck: "Please check your email and enter the code below.",
          invalidEmail: "Please enter a valid email address",
          usernameExists: "This username is already taken",
          emailExists: "An account with this email already exists",
          passwordsDontMatch: "Passwords don't match",
          passwordTooShort: "Password must be at least 6 characters",
          fieldRequired: "This field is required",
          verificationFailed: "Verification failed. Please try again.",
          accountCreated: "Account created successfully! You can now login.",
          verificationSuccess: "Email verified successfully!",
          resendSuccess: "Verification code resent!",
          resendError: "Error resending code. Please try again.",
          signupAsStudent: "Sign up as Student",
          signupAsTeacher: "Sign up as Teacher",
          studentClass: "Your Class",
          teacherClass: "Your Class/Grade",
          createAccount: "Create Account",
          continue: "Continue",
          verificationInProgress: "Verifying...",
          signupSuccess: "Registration Complete!",
          signupSuccessDesc: "Your account has been created. Please verify your email to login.",
          dontHaveAccount: "Don't have an account?",
          alreadyHaveAccount: "Already have an account?",
          loginWithCredentials: "Login with your username and password",
          enterYourCredentials: "Enter your credentials to access your account",
          adminButton: "🔒 Admin",
          adminPrompt: "Enter Admin Code",
          cancel: "Cancel",
          submit: "Submit",
          save: "Save",
          edit: "Edit",
          update: "Update",
          remove: "Remove",
          upload: "Upload",
          file: "File",
          chooseFile: "Choose File",
          uploadFile: "Upload File",
          myClasses: "My Classes",
          createClass: "Create Class",
          className: "Class Name:",
          classCode: "Class Code:",
          students: "Students",
          addStudent: "Add Student",
          studentName: "Student Name:",
          studentEmail: "Student Email:",
          studentUsername: "Student Username:",
          materials: "Materials",
          uploadMaterial: "Upload Material",
          materialName: "Material Name:",
          materialType: "Material Type:",
          notes: "Notes",
          presentations: "Presentations",
          worksheets: "Worksheets",
          videos: "Videos",
          assignments: "Assignments",
          addMaterial: "Add Material",
          noMaterials: "No materials uploaded yet.",
          classProgress: "Class Progress",
          studentNameHeader: "Student Name",
          completionRate: "Completion Rate",
          quizScore: "Quiz Score",
          assignmentScore: "Assignment Score",
          actions: "Actions",
          editClass: "Edit Class",
          deleteClass: "Delete Class",
          confirmDeleteClass: "Are you sure you want to delete this class? This will remove all students and materials.",
          classCreated: "Class created successfully!",
          materialUploaded: "Material uploaded successfully!",
          studentAdded: "Student added to class successfully!",
          invalidClassCode: "Invalid class code. Please try again.",
          joinClass: "Join Class",
          enterClassCode: "Enter Class Code:",
          join: "Join",
          myClasses: "My Classes",
          noClasses: "You haven't joined any classes yet.",
          classDetails: "Class Details",
          teacher: "Teacher:",
          classCode: "Class Code:",
          joinedDate: "Joined Date:",
          leaveClass: "Leave Class",
          confirmLeaveClass: "Are you sure you want to leave this class?",
          search: "Search",
          searchMaterials: "Search materials...",
          filterByType: "Filter by Type",
          all: "All",
          sortBy: "Sort by",
          dateUploaded: "Date Uploaded",
          name: "Name",
          uploadDate: "Upload Date",
          type: "Type"
        },
        zh: {
          title: "CWA中学生物学",
          home: "首页",
          library: "资料库",
          exercises: "练习",
          assignments: "作业",
          progress: "进度",
          admin: "管理员",
          welcome: "欢迎来到CWA中学生物学",
          adminAccess: "管理员访问",
          enterCode: "输入管理员代码：",
          accessGranted: "访问已授权！",
          invalidCode: "代码无效。请重试。",
          logout: "登出",
          unitManagement: "单元管理",
          addUnit: "添加单元",
          editUnit: "编辑单元",
          deleteUnit: "删除单元",
          unitCode: "单元代码：",
          unitTitle: "单元标题：",
          description: "描述：",
          units: "单元",
          content: "内容",
          exercises: "练习",
          videos: "视频",
          manageUnits: "管理单元",
          createUnit: "创建单元",
          confirmUnitDelete: "您确定要删除此单元吗？这将同时删除所有相关的内容、作业和测验。",
          back: "返回",
          home: "首页",
          language: "语言",
          english: "英文",
          chinese: "中文",
          login: "登录",
          register: "注册",
          signup: "注册",
          username: "用户名",
          password: "密码",
          confirmPassword: "确认密码",
          email: "邮箱",
          name: "姓名",
          class: "班级",
          role: "角色",
          student: "学生",
          teacher: "教师",
          loginToContinue: "请登录以继续",
          myProgress: "我的进度",
          completedUnits: "完成单元：",
          quizAverage: "测验平均分：",
          assignmentsCompleted: "完成作业：",
          lastActive: "最后活动：",
          studentDashboard: "学生仪表板",
          teacherDashboard: "教师仪表板",
          manageStudents: "管理学生",
          createAssignment: "创建作业",
          viewProgress: "查看进度",
          welcomeBack: "欢迎回来",
          account: "账户",
          profile: "个人资料",
          settings: "设置",
          next: "下一步",
          verifyEmail: "验证邮箱",
          verificationCode: "验证码",
          resendCode: "重新发送",
          emailVerification: "邮箱验证",
          verificationSent: "验证码已发送到您的邮箱。请查收。",
          verify: "验证",
          emailSent: "验证邮件已发送！",
          codeSent: "6位验证码已发送至",
          pleaseCheck: "请查收邮件并输入下方验证码。",
          invalidEmail: "请输入有效的邮箱地址",
          usernameExists: "该用户名已被占用",
          emailExists: "该邮箱已注册过账户",
          passwordsDontMatch: "密码不匹配",
          passwordTooShort: "密码至少需要6个字符",
          fieldRequired: "此字段为必填项",
          verificationFailed: "验证失败，请重试。",
          accountCreated: "账户创建成功！现在可以登录。",
          verificationSuccess: "邮箱验证成功！",
          resendSuccess: "验证码已重新发送！",
          resendError: "重新发送验证码出错，请重试。",
          signupAsStudent: "学生注册",
          signupAsTeacher: "教师注册",
          studentClass: "您的班级",
          teacherClass: "您的班级/年级",
          createAccount: "创建账户",
          continue: "继续",
          verificationInProgress: "正在验证...",
          signupSuccess: "注册完成！",
          signupSuccessDesc: "您的账户已创建。请验证邮箱后登录。",
          dontHaveAccount: "还没有账户？",
          alreadyHaveAccount: "已有账户？",
          loginWithCredentials: "使用您的用户名和密码登录",
          enterYourCredentials: "输入您的凭据以访问您的账户",
          adminButton: "🔒 管理员",
          adminPrompt: "输入管理员代码",
          cancel: "取消",
          submit: "提交",
          save: "保存",
          edit: "编辑",
          update: "更新",
          remove: "删除",
          upload: "上传",
          file: "文件",
          chooseFile: "选择文件",
          uploadFile: "上传文件",
          myClasses: "我的班级",
          createClass: "创建班级",
          className: "班级名称：",
          classCode: "班级代码：",
          students: "学生",
          addStudent: "添加学生",
          studentName: "学生姓名：",
          studentEmail: "学生邮箱：",
          studentUsername: "学生用户名：",
          materials: "资料",
          uploadMaterial: "上传资料",
          materialName: "资料名称：",
          materialType: "资料类型：",
          notes: "笔记",
          presentations: "演示文稿",
          worksheets: "工作表",
          videos: "视频",
          assignments: "作业",
          addMaterial: "添加资料",
          noMaterials: "暂无上传的资料。",
          classProgress: "班级进度",
          studentNameHeader: "学生姓名",
          completionRate: "完成率",
          quizScore: "测验分数",
          assignmentScore: "作业分数",
          actions: "操作",
          editClass: "编辑班级",
          deleteClass: "删除班级",
          confirmDeleteClass: "您确定要删除此班级吗？这将移除所有学生和资料。",
          classCreated: "班级创建成功！",
          materialUploaded: "资料上传成功！",
          studentAdded: "学生已成功添加到班级！",
          invalidClassCode: "无效的班级代码。请重试。",
          joinClass: "加入班级",
          enterClassCode: "输入班级代码：",
          join: "加入",
          myClasses: "我的班级",
          noClasses: "您还没有加入任何班级。",
          classDetails: "班级详情",
          teacher: "教师：",
          classCode: "班级代码：",
          joinedDate: "加入日期：",
          leaveClass: "离开班级",
          confirmLeaveClass: "您确定要离开此班级吗？",
          search: "搜索",
          searchMaterials: "搜索资料...",
          filterByType: "按类型筛选",
          all: "全部",
          sortBy: "排序方式",
          dateUploaded: "上传日期",
          name: "名称",
          uploadDate: "上传日期",
          type: "类型"
        }
      };

      const t = translations[currentLanguage];

      // Teacher classes state
      const [teacherClasses, setTeacherClasses] = useState([]);
      const [studentClasses, setStudentClasses] = useState([]);
      const [selectedClass, setSelectedClass] = useState(null);
      const [classForm, setClassForm] = useState({
        name: "",
        code: ""
      });
      const [studentForm, setStudentForm] = useState({
        name: "",
        email: "",
        username: ""
      });
      const [materialForm, setMaterialForm] = useState({
        name: "",
        type: "notes",
        file: null
      });

      // Verify admin code
      const verifyAdminCode = useCallback((code) => {
        if (code === ADMIN_CONFIG.secretCode) {
          setIsAuthenticated(true);
          setCurrentPage("admin");
          setNavigationHistory([...navigationHistory, "admin"]);
          setShowAdminPrompt(false);
          setAdminCode("");
          return true;
        }
        return false;
      }, [navigationHistory]);

      // Show admin prompt
      const showAdminPromptHandler = useCallback(() => {
        setShowAdminPrompt(true);
        setAdminCode("");
        // Focus on the input field after a short delay
        setTimeout(() => {
          if (adminCodeRef.current) {
            adminCodeRef.current.focus();
          }
        }, 100);
      }, []);

      // Handle admin code submission
      const handleAdminSubmit = useCallback((e) => {
        e.preventDefault();
        if (verifyAdminCode(adminCode)) {
          // Success - already handled in verifyAdminCode
        } else {
          alert(t.invalidCode);
        }
      }, [adminCode, verifyAdminCode, t.invalidCode]);

      // Close admin prompt
      const closeAdminPrompt = useCallback(() => {
        setShowAdminPrompt(false);
        setAdminCode("");
      }, []);

      // User login
      const handleLogin = useCallback((e) => {
        e.preventDefault();
        const foundUser = users.find(u => u.username === loginForm.username && u.password === loginForm.password);
        
        if (foundUser) {
          if (!foundUser.emailVerified) {
            alert("Please verify your email before logging in.");
            return;
          }
          setUser(foundUser);
          setCurrentPage("home");
          setNavigationHistory(["home"]);
          
          // Initialize teacher classes if user is a teacher
          if (foundUser.role === "teacher") {
            const userClasses = teacherClasses.filter(c => c.teacherId === foundUser.id);
            setTeacherClasses(userClasses);
          }
          
          // Reset login form
          setLoginForm({
            username: "",
            password: ""
          });
        } else {
          alert("Invalid username or password");
        }
      }, [loginForm.username, loginForm.password, users, teacherClasses]);

      // User logout
      const handleLogout = useCallback(() => {
        setUser(null);
        setIsAuthenticated(false);
        setCurrentPage("home");
        setNavigationHistory(["home"]);
        setTeacherClasses([]);
        setStudentClasses([]);
        setSelectedClass(null);
        window.history.pushState({}, document.title, window.location.pathname);
      }, []);

      // Navigation with history tracking
      const navigateTo = useCallback((page) => {
        if (page !== "login" && page !== "signup" && !user && !isAuthenticated) {
          setCurrentPage("login");
          setNavigationHistory([...navigationHistory, "login"]);
          return;
        }
        
        setCurrentPage(page);
        setNavigationHistory([...navigationHistory, page]);
      }, [user, isAuthenticated, navigationHistory]);

      // Go back function
      const goBack = useCallback(() => {
        if (navigationHistory.length > 1) {
          const newHistory = navigationHistory.slice(0, -1);
          setNavigationHistory(newHistory);
          setCurrentPage(newHistory[newHistory.length - 1]);
        }
      }, [navigationHistory]);

      // Go home function
      const goHome = useCallback(() => {
        setCurrentPage("home");
        setNavigationHistory(["home"]);
      }, []);

      // Admin tab navigation
      const navigateToAdminTab = useCallback((tab) => {
        setActiveAdminTab(tab);
      }, []);

      // Unit Management Functions
      const [unitForm, setUnitForm] = useState({
        unit: "",
        title: "",
        description: ""
      });

      const handleUnitChange = useCallback((field, value) => {
        setUnitForm(prev => ({
          ...prev,
          [field]: value
        }));
      }, []);

      const saveUnit = useCallback(() => {
        if (!unitForm.unit || !unitForm.title) {
          alert("Please fill in unit code and title");
          return;
        }

        // Check if unit code already exists
        const unitExists = content.some(c => c.unit === unitForm.unit);
        if (unitExists) {
          alert("A unit with this code already exists. Please use a different code.");
          return;
        }

        const newUnit = { 
          unit: unitForm.unit,
          title: unitForm.title,
          description: unitForm.description || "",
          articles: [],
          exercises: [],
          videos: []
        };
        
        setContent(prev => [...prev, newUnit]);

        // Reset form
        setUnitForm({
          unit: "",
          title: "",
          description: ""
        });
        alert("Unit created successfully!");
      }, [unitForm.unit, unitForm.title, unitForm.description, content]);

      // Delete unit
      const deleteUnit = useCallback((unitId) => {
        if (window.confirm("Are you sure you want to delete this unit? This will also remove all associated content, assignments, and quizzes.")) {
          // Remove unit from content
          setContent(prev => prev.filter(u => u.unit !== unitId));
          alert("Unit deleted successfully!");
        }
      }, []);

      // Edit unit
      const [editingUnit, setEditingUnit] = useState(null);
      const startEditUnit = useCallback((unit) => {
        setEditingUnit(unit);
        setUnitForm({
          unit: unit.unit,
          title: unit.title,
          description: unit.description || ""
        });
      }, []);

      const updateUnit = useCallback(() => {
        if (!unitForm.unit || !unitForm.title) {
          alert("Please fill in unit code and title");
          return;
        }

        setContent(prev => prev.map(u => 
          u.unit === editingUnit.unit 
            ? { ...u, title: unitForm.title, description: unitForm.description }
            : u
        ));

        setEditingUnit(null);
        setUnitForm({
          unit: "",
          title: "",
          description: ""
        });
        alert("Unit updated successfully!");
      }, [unitForm.unit, unitForm.title, unitForm.description, editingUnit]);

      // Cancel edit
      const cancelEditUnit = useCallback(() => {
        setEditingUnit(null);
        setUnitForm({
          unit: "",
          title: "",
          description: ""
        });
      }, []);

      // Add content to unit
      const [contentForm, setContentForm] = useState({
        type: "article",
        title: "",
        content: "",
        url: "",
        duration: "",
        description: ""
      });

      const [selectedUnit, setSelectedUnit] = useState(null);
      const [editingContent, setEditingContent] = useState(null);

      const startAddContent = useCallback((unit) => {
        setSelectedUnit(unit);
        setContentForm({
          type: "article",
          title: "",
          content: "",
          url: "",
          duration: "",
          description: ""
        });
        setEditingContent(null);
      }, []);

      const startEditContent = useCallback((unit, contentType, contentItem) => {
        setSelectedUnit(unit);
        setEditingContent({type: contentType, item: contentItem});
        if (contentType === "article") {
          setContentForm({
            type: "article",
            title: contentItem.title,
            content: contentItem.content,
            url: "",
            duration: "",
            description: ""
          });
        } else if (contentType === "exercise") {
          setContentForm({
            type: "exercise",
            title: contentItem.question,
            content: "",
            url: "",
            duration: "",
            description: ""
          });
        } else if (contentType === "video") {
          setContentForm({
            type: "video",
            title: contentItem.title,
            content: "",
            url: contentItem.url,
            duration: contentItem.duration,
            description: contentItem.description
          });
        }
      }, []);

      const saveContent = useCallback(() => {
        if (!contentForm.title) {
          alert("Please enter a title");
          return;
        }

        if (editingContent) {
          // Update existing content
          setContent(prev => prev.map(u => {
            if (u.unit === selectedUnit.unit) {
              if (editingContent.type === "article") {
                return {
                  ...u,
                  articles: u.articles.map(a => 
                    a.id === editingContent.item.id 
                      ? { ...a, title: contentForm.title, content: contentForm.content }
                      : a
                  )
                };
              } else if (editingContent.type === "exercise") {
                return {
                  ...u,
                  exercises: u.exercises.map(e => 
                    e.id === editingContent.item.id 
                      ? { ...e, question: contentForm.title }
                      : e
                  )
                };
              } else if (editingContent.type === "video") {
                return {
                  ...u,
                  videos: u.videos.map(v => 
                    v.id === editingContent.item.id 
                      ? { ...v, title: contentForm.title, url: contentForm.url, duration: contentForm.duration, description: contentForm.description }
                      : v
                  )
                };
              }
            }
            return u;
          }));

          setEditingContent(null);
        } else {
          // Add new content
          const newId = Date.now();
          const newContent = {
            id: newId,
            title: contentForm.title,
            lastUpdated: new Date().toISOString().split('T')[0]
          };

          if (contentForm.type === "article") {
            newContent.content = contentForm.content;
            newContent.level = "Beginner";
          } else if (contentForm.type === "exercise") {
            newContent.question = contentForm.title;
            newContent.type = "short-answer";
            newContent.difficulty = "easy";
            newContent.points = 5;
          } else if (contentForm.type === "video") {
            newContent.url = contentForm.url;
            newContent.duration = contentForm.duration;
            newContent.thumbnail = "https://placehold.co/400x225?text=Video+Thumbnail";
            newContent.description = contentForm.description;
          }

          setContent(prev => prev.map(u => 
            u.unit === selectedUnit.unit 
              ? { 
                  ...u, 
                  [contentForm.type === "article" ? "articles" : contentForm.type === "exercise" ? "exercises" : "videos"]: 
                    [...u[contentForm.type === "article" ? "articles" : contentForm.type === "exercise" ? "exercises" : "videos"], newContent]
                }
              : u
          ));
        }

        // Reset form
        setContentForm({
          type: "article",
          title: "",
          content: "",
          url: "",
          duration: "",
          description: ""
        });
        setSelectedUnit(null);
        alert(`${editingContent ? 'Updated' : 'Added'} content successfully!`);
      }, [contentForm, editingContent, selectedUnit]);

      const deleteContent = useCallback((unitId, contentType, contentId) => {
        if (window.confirm("Are you sure you want to delete this content?")) {
          setContent(prev => prev.map(u => {
            if (u.unit === unitId) {
              if (contentType === "article") {
                return {
                  ...u,
                  articles: u.articles.filter(a => a.id !== contentId)
                };
              } else if (contentType === "exercise") {
                return {
                  ...u,
                  exercises: u.exercises.filter(e => e.id !== contentId)
                };
              } else if (contentType === "video") {
                return {
                  ...u,
                  videos: u.videos.filter(v => v.id !== contentId)
                };
              }
            }
            return u;
          }));
          alert("Content deleted successfully!");
        }
      }, []);

      const cancelAddContent = useCallback(() => {
        setContentForm({
          type: "article",
          title: "",
          content: "",
          url: "",
          duration: "",
          description: ""
        });
        setSelectedUnit(null);
        setEditingContent(null);
      }, []);

      // Teacher class management
      const createClass = useCallback(() => {
        if (!classForm.name || !classForm.code) {
          alert("Please fill in class name and code");
          return;
        }

        // Check if class code already exists
        const classExists = teacherClasses.some(c => c.code === classForm.code);
        if (classExists) {
          alert("A class with this code already exists. Please use a different code.");
          return;
        }

        const newClass = {
          id: Date.now(),
          name: classForm.name,
          code: classForm.code,
          teacherId: user.id,
          teacherName: user.name,
          students: [],
          materials: [],
          createdAt: new Date().toISOString().split('T')[0],
          updatedAt: new Date().toISOString().split('T')[0]
        };

        setTeacherClasses(prev => [...prev, newClass]);
        
        // Reset form
        setClassForm({
          name: "",
          code: ""
        });
        alert(t.classCreated);
      }, [classForm.name, classForm.code, user, teacherClasses, t.classCreated]);

      const updateClass = useCallback(() => {
        if (!classForm.name || !classForm.code) {
          alert("Please fill in class name and code");
          return;
        }

        setTeacherClasses(prev => prev.map(c => 
          c.id === selectedClass.id 
            ? { 
                ...c, 
                name: classForm.name, 
                code: classForm.code,
                updatedAt: new Date().toISOString().split('T')[0]
              }
            : c
        ));

        setSelectedClass(null);
        setClassForm({
          name: "",
          code: ""
        });
        alert("Class updated successfully!");
      }, [classForm.name, classForm.code, selectedClass]);

      const deleteClass = useCallback((classId) => {
        if (window.confirm(t.confirmDeleteClass)) {
          setTeacherClasses(prev => prev.filter(c => c.id !== classId));
          alert("Class deleted successfully!");
        }
      }, [t.confirmDeleteClass]);

      const startEditClass = useCallback((classObj) => {
        setSelectedClass(classObj);
        setClassForm({
          name: classObj.name,
          code: classObj.code
        });
      }, []);

      const cancelEditClass = useCallback(() => {
        setSelectedClass(null);
        setClassForm({
          name: "",
          code: ""
        });
      }, []);

      // Student management in class
      const addStudent = useCallback(() => {
        if (!studentForm.name || !studentForm.email || !studentForm.username) {
          alert("Please fill in all student fields");
          return;
        }

        // Find the student user
        const studentUser = users.find(u => u.username === studentForm.username && u.email === studentForm.email);
        if (!studentUser) {
          alert("Student not found. Please check the username and email.");
          return;
        }

        if (studentUser.role !== "student") {
          alert("The specified user is not a student.");
          return;
        }

        setTeacherClasses(prev => prev.map(c => 
          c.id === selectedClass.id 
            ? { 
                ...c, 
                students: [...c.students, {
                  id: studentUser.id,
                  name: studentForm.name,
                  email: studentForm.email,
                  username: studentForm.username,
                  joinedDate: new Date().toISOString().split('T')[0],
                  progress: {
                    completionRate: 0,
                    quizScore: 0,
                    assignmentScore: 0
                  }
                }],
                updatedAt: new Date().toISOString().split('T')[0]
              }
            : c
        ));

        // Reset form
        setStudentForm({
          name: "",
          email: "",
          username: ""
        });
        alert(t.studentAdded);
      }, [studentForm.name, studentForm.email, studentForm.username, selectedClass, users, t.studentAdded]);

      const removeStudent = useCallback((classId, studentId) => {
        if (window.confirm("Are you sure you want to remove this student from the class?")) {
          setTeacherClasses(prev => prev.map(c => 
            c.id === classId 
              ? { 
                  ...c, 
                  students: c.students.filter(s => s.id !== studentId),
                  updatedAt: new Date().toISOString().split('T')[0]
                }
              : c
          ));
          alert("Student removed from class successfully!");
        }
      }, []);

      // Material management
      const addMaterial = useCallback(() => {
        if (!materialForm.name || !materialForm.file) {
          alert("Please enter a material name and select a file");
          return;
        }

        const newMaterial = {
          id: Date.now(),
          name: materialForm.name,
          type: materialForm.type,
          file: materialForm.file,
          uploadedBy: user.name,
          uploadDate: new Date().toISOString().split('T')[0],
          downloads: 0
        };

        setTeacherClasses(prev => prev.map(c => 
          c.id === selectedClass.id 
            ? { 
                ...c, 
                materials: [...c.materials, newMaterial],
                updatedAt: new Date().toISOString().split('T')[0]
              }
            : c
        ));

        // Reset form
        setMaterialForm({
          name: "",
          type: "notes",
          file: null
        });
        alert(t.materialUploaded);
      }, [materialForm.name, materialForm.file, materialForm.type, selectedClass, user, t.materialUploaded]);

      const removeMaterial = useCallback((classId, materialId) => {
        if (window.confirm("Are you sure you want to delete this material?")) {
          setTeacherClasses(prev => prev.map(c => 
            c.id === classId 
              ? { 
                  ...c, 
                  materials: c.materials.filter(m => m.id !== materialId),
                  updatedAt: new Date().toISOString().split('T')[0]
                }
              : c
          ));
          alert("Material deleted successfully!");
        }
      }, []);

      const handleFileChange = useCallback((e) => {
        setMaterialForm(prev => ({
          ...prev,
          file: e.target.files[0]
        }));
      }, []);

      // Student class joining
      const [joinClassCode, setJoinClassCode] = useState("");
      const joinClass = useCallback(() => {
        if (!joinClassCode) {
          alert("Please enter a class code");
          return;
        }

        // Find the class
        const classToJoin = teacherClasses.find(c => c.code === joinClassCode);
        if (!classToJoin) {
          alert(t.invalidClassCode);
          return;
        }

        // Check if student is already in the class
        const alreadyJoined = studentClasses.some(c => c.id === classToJoin.id);
        if (alreadyJoined) {
          alert("You are already a member of this class.");
          return;
        }

        // Add student to class
        const updatedClass = {
          ...classToJoin,
          students: [
            ...classToJoin.students,
            {
              id: user.id,
              name: user.name,
              email: user.email,
              username: user.username,
              joinedDate: new Date().toISOString().split('T')[0],
              progress: {
                completionRate: 0,
                quizScore: 0,
                assignmentScore: 0
              }
            }
          ]
        };

        // Update the class in teacherClasses
        setTeacherClasses(prev => prev.map(c => 
          c.id === classToJoin.id ? updatedClass : c
        ));

        // Add class to student's classes
        setStudentClasses(prev => [...prev, {
          id: classToJoin.id,
          name: classToJoin.name,
          code: classToJoin.code,
          teacherId: classToJoin.teacherId,
          teacherName: classToJoin.teacherName,
          joinedDate: new Date().toISOString().split('T')[0]
        }]);

        setJoinClassCode("");
        alert("Successfully joined class!");
      }, [joinClassCode, teacherClasses, studentClasses, user, t.invalidClassCode]);

      const leaveClass = useCallback((classId) => {
        if (window.confirm(t.confirmLeaveClass)) {
          // Remove student from class
          setTeacherClasses(prev => prev.map(c => 
            c.id === classId 
              ? { 
                  ...c, 
                  students: c.students.filter(s => s.id !== user.id)
                }
              : c
          ));

          // Remove class from student's classes
          setStudentClasses(prev => prev.filter(c => c.id !== classId));
          
          alert("Successfully left class!");
        }
      }, [user, t.confirmLeaveClass]);

      // Check for admin access on load
      useEffect(() => {
        const urlParams = new URLSearchParams(window.location.search);
        const code = urlParams.get('admin');
        if (code === ADMIN_CONFIG.secretCode) {
          setIsAuthenticated(true);
          setCurrentPage("admin");
          setNavigationHistory(["home", "admin"]);
        }
      }, []);

      // Update form state functions that maintain focus
      const updateLoginForm = useCallback((field, value) => {
        setLoginForm(prev => ({
          ...prev,
          [field]: value
        }));
      }, []);

      const updateSignupForm = useCallback((field, value) => {
        setSignupForm(prev => ({
          ...prev,
          [field]: value
        }));
      }, []);

      const updateClassForm = useCallback((field, value) => {
        setClassForm(prev => ({
          ...prev,
          [field]: value
        }));
      }, []);

      const updateStudentForm = useCallback((field, value) => {
        setStudentForm(prev => ({
          ...prev,
          [field]: value
        }));
      }, []);

      const updateMaterialForm = useCallback((field, value) => {
        setMaterialForm(prev => ({
          ...prev,
          [field]: value
        }));
      }, []);

      // Header Component with Navigation
      const Header = () => (
        <div style={{
          background: "white",
          padding: "15px 20px",
          borderBottom: "1px solid #e0e0e0",
          display: "flex",
          alignItems: "center",
          justifyContent: "space-between",
          position: "sticky",
          top: 0,
          zIndex: 100,
          boxShadow: "0 2px 10px rgba(0, 0, 0, 0.1)"
        }}>
          <div style={{
            display: "flex",
            alignItems: "center",
            gap: "15px"
          }}>
            {/* Back and Home buttons */}
            {navigationHistory.length > 1 && (
              <button 
                onClick={goBack}
                style={{
                  background: "#e0e0e0",
                  border: "none",
                  padding: "8px 12px",
                  borderRadius: "8px",
                  fontSize: "14px",
                  fontWeight: "500",
                  cursor: "pointer",
                  display: "flex",
                  alignItems: "center",
                  gap: "5px"
                }}
              >
                ← {t.back}
              </button>
            )}
            
            {currentPage !== "home" && (
              <button 
                onClick={goHome}
                style={{
                  background: "#4caf50",
                  color: "white",
                  border: "none",
                  padding: "8px 12px",
                  borderRadius: "8px",
                  fontSize: "14px",
                  fontWeight: "500",
                  cursor: "pointer",
                  display: "flex",
                  alignItems: "center",
                  gap: "5px"
                }}
              >
                🏠 {t.home}
              </button>
            )}
          </div>

          <h1 style={{
            fontSize: "20px",
            fontWeight: "700",
            color: "#2e7d32",
            margin: "0",
            textAlign: "center",
            flex: 1
          }}>
            {t.title}
          </h1>

          <div style={{
            display: "flex",
            alignItems: "center",
            gap: "15px"
          }}>
            {/* User Account or Login */}
            {user ? (
              <div style={{
                display: "flex",
                alignItems: "center",
                gap: "10px"
              }}>
                <span style={{
                  fontSize: "14px",
                  color: "#666"
                }}>
                  {t.welcomeBack}, {user.name}
                </span>
                <button 
                  onClick={handleLogout}
                  style={{
                    background: "#f44336",
                    color: "white",
                    border: "none",
                    padding: "6px 12px",
                    borderRadius: "6px",
                    fontSize: "14px",
                    cursor: "pointer"
                  }}
                >
                  {t.logout}
                </button>
              </div>
            ) : !isAuthenticated && (
              <div style={{
                display: "flex",
                alignItems: "center",
                gap: "10px"
              }}>
                <button 
                  onClick={() => navigateTo("login")}
                  style={{
                    background: "#2196f3",
                    color: "white",
                    border: "none",
                    padding: "6px 12px",
                    borderRadius: "6px",
                    fontSize: "14px",
                    cursor: "pointer"
                  }}
                >
                  {t.login}
                </button>
                <button 
                  onClick={() => navigateTo("signup")}
                  style={{
                    background: "#4caf50",
                    color: "white",
                    border: "none",
                    padding: "6px 12px",
                    borderRadius: "6px",
                    fontSize: "14px",
                    cursor: "pointer"
                  }}
                >
                  {t.signup}
                </button>
              </div>
            )}

            {/* Admin Button - Always visible but secure */}
            <button 
              onClick={showAdminPromptHandler}
              style={{
                background: "linear-gradient(135deg, #673ab7, #9c27b0)",
                color: "white",
                border: "none",
                padding: "8px 12px",
                borderRadius: "8px",
                fontSize: "14px",
                fontWeight: "600",
                cursor: "pointer"
              }}
            >
              {t.adminButton}
            </button>

            {/* Language Toggle */}
            <div style={{
              display: "flex",
              alignItems: "center",
              gap: "10px",
              fontSize: "14px",
              fontWeight: "500"
            }}>
              <span style={{
                opacity: currentLanguage === "en" ? 1 : 0.6,
                cursor: "pointer",
                color: currentLanguage === "en" ? "#4caf50" : "#666"
              }} onClick={() => setCurrentLanguage("en")}>
                {t.english}
              </span>
              <span style={{color: "#999"}}>|</span>
              <span style={{
                opacity: currentLanguage === "zh" ? 1 : 0.6,
                cursor: "pointer",
                color: currentLanguage === "zh" ? "#4caf50" : "#666"
              }} onClick={() => setCurrentLanguage("zh")}>
                {t.chinese}
              </span>
            </div>
          </div>

          {/* Admin Prompt Overlay */}
          {showAdminPrompt && (
            <div style={{
              position: "fixed",
              top: 0,
              left: 0,
              right: 0,
              bottom: 0,
              background: "rgba(0, 0, 0, 0.5)",
              display: "flex",
              alignItems: "center",
              justifyContent: "center",
              zIndex: 1000
            }}>
              <div style={{
                background: "white",
                borderRadius: "12px",
                padding: "40px",
                width: "100%",
                maxWidth: "400px",
                boxShadow: "0 8px 25px rgba(0, 0, 0, 0.1)"
              }}>
                <div style={{
                  textAlign: "center",
                  marginBottom: "30px"
                }}>
                  <div style={{
                    fontSize: "80px",
                    marginBottom: "20px"
                  }}>
                    🔐
                  </div>
                  <h2 style={{
                    fontSize: "28px",
                    fontWeight: "700",
                    color: "#333",
                    margin: "0"
                  }}>
                    {t.adminPrompt}
                  </h2>
                </div>
                
                <form onSubmit={handleAdminSubmit} style={{
                  spaceY: "20px"
                }}>
                  <div style={{
                    marginBottom: "20px"
                  }}>
                    <input
                      ref={adminCodeRef}
                      type="password"
                      value={adminCode}
                      onChange={(e) => setAdminCode(e.target.value)}
                      style={{
                        width: "100%",
                        border: "2px solid #ddd",
                        borderRadius: "8px",
                        padding: "12px",
                        fontSize: "16px",
                        outline: "none",
                        textAlign: "center"
                      }}
                      placeholder={t.enterCode}
                    />
                  </div>
                  
                  <div style={{
                    display: "flex",
                    gap: "10px"
                  }}>
                    <button
                      type="button"
                      onClick={closeAdminPrompt}
                      style={{
                        flex: 1,
                        background: "#9e9e9e",
                        color: "white",
                        border: "none",
                        padding: "12px",
                        borderRadius: "8px",
                        fontSize: "16px",
                        fontWeight: "600",
                        cursor: "pointer"
                      }}
                    >
                      {t.cancel}
                    </button>
                    <button
                      type="submit"
                      style={{
                        flex: 1,
                        background: "linear-gradient(135deg, #4caf50, #66bb6a)",
                        color: "white",
                        border: "none",
                        padding: "12px",
                        borderRadius: "8px",
                        fontSize: "16px",
                        fontWeight: "600",
                        cursor: "pointer"
                      }}
                    >
                      {t.submit}
                    </button>
                  </div>
                </form>
              </div>
            </div>
          )}
        </div>
      );

      // Login Page
      const LoginPage = () => {
        // Focus management for login inputs
        useEffect(() => {
          const timer = setTimeout(() => {
            if (loginUsernameRef.current && !loginForm.username) {
              loginUsernameRef.current.focus();
            }
          }, 100);
          return () => clearTimeout(timer);
        }, []);

        return (
          <div style={{
            display: "flex",
            alignItems: "center",
            justifyContent: "center",
            minHeight: "100vh",
            background: "#e8f5e8",
            padding: "20px"
          }}>
            <div style={{
              background: "white",
              borderRadius: "12px",
              padding: "40px",
              width: "100%",
              maxWidth: "400px",
              boxShadow: "0 8px 25px rgba(0, 0, 0, 0.1)"
            }}>
              <div style={{
                textAlign: "center",
                marginBottom: "30px"
              }}>
                <div style={{
                  fontSize: "60px",
                  marginBottom: "20px"
                }}>
                  👤
                </div>
                <h2 style={{
                  fontSize: "28px",
                  fontWeight: "700",
                  color: "#333",
                  margin: "0"
                }}>
                  {t.login}
                </h2>
                <p style={{
                  color: "#666",
                  marginTop: "10px"
                }}>
                  {t.enterYourCredentials}
                </p>
              </div>
              
              <form onSubmit={handleLogin} style={{
                spaceY: "20px"
              }}>
                <div style={{
                  marginBottom: "20px"
                }}>
                  <label style={{
                    display: "block",
                    fontSize: "14px",
                    fontWeight: "500",
                    color: "#333",
                    marginBottom: "8px"
                  }}>
                    {t.username}
                  </label>
                  <input
                    ref={loginUsernameRef}
                    type="text"
                    value={loginForm.username}
                    onChange={(e) => updateLoginForm("username", e.target.value)}
                    style={{
                      width: "100%",
                      border: "2px solid #ddd",
                      borderRadius: "8px",
                      padding: "12px",
                      fontSize: "16px",
                      outline: "none"
                    }}
                    placeholder="Enter your username"
                    required
                    autoComplete="username"
                  />
                </div>
                
                <div style={{
                  marginBottom: "20px"
                }}>
                  <label style={{
                    display: "block",
                    fontSize: "14px",
                    fontWeight: "500",
                    color: "#333",
                    marginBottom: "8px"
                  }}>
                    {t.password}
                  </label>
                  <input
                    ref={loginPasswordRef}
                    type="password"
                    value={loginForm.password}
                    onChange={(e) => updateLoginForm("password", e.target.value)}
                    style={{
                      width: "100%",
                      border: "2px solid #ddd",
                      borderRadius: "8px",
                      padding: "12px",
                      fontSize: "16px",
                      outline: "none"
                    }}
                    placeholder="Enter your password"
                    required
                    autoComplete="current-password"
                  />
                </div>
                
                <button
                  type="submit"
                  style={{
                    width: "100%",
                    background: "linear-gradient(135deg, #4caf50, #66bb6a)",
                    color: "white",
                    border: "none",
                    padding: "12px",
                    borderRadius: "8px",
                    fontSize: "16px",
                    fontWeight: "600",
                    cursor: "pointer"
                  }}
                >
                  {t.login}
                </button>
              </form>
              
              <div style={{
                textAlign: "center",
                marginTop: "20px"
              }}>
                <p style={{
                  color: "#666",
                  fontSize: "14px"
                }}>
                  {t.dontHaveAccount}{" "}
                  <button 
                    onClick={() => navigateTo("signup")}
                    style={{
                      background: "none",
                      border: "none",
                      color: "#2196f3",
                      fontWeight: "500",
                      cursor: "pointer"
                    }}
                  >
                    {t.signup}
                  </button>
                </p>
              </div>
            </div>
          </div>
        );
      };

      // Signup Page
      const SignupPage = () => {
        const [errors, setErrors] = useState({});
        const [showPassword, setShowPassword] = useState(false);
        const [showConfirmPassword, setShowConfirmPassword] = useState(false);

        const validateForm = useCallback(() => {
          const newErrors = {};
          
          if (!signupForm.name.trim()) {
            newErrors.name = t.fieldRequired;
          }
          
          if (!signupForm.email.trim()) {
            newErrors.email = t.fieldRequired;
          } else if (!/\S+@\S+\.\S+/.test(signupForm.email)) {
            newErrors.email = t.invalidEmail;
          } else if (users.some(u => u.email === signupForm.email)) {
            newErrors.email = t.emailExists;
          }
          
          if (!signupForm.username.trim()) {
            newErrors.username = t.fieldRequired;
          } else if (users.some(u => u.username === signupForm.username)) {
            newErrors.username = t.usernameExists;
          }
          
          if (!signupForm.password) {
            newErrors.password = t.fieldRequired;
          } else if (signupForm.password.length < 6) {
            newErrors.password = t.passwordTooShort;
          }
          
          if (!signupForm.confirmPassword) {
            newErrors.confirmPassword = t.fieldRequired;
          } else if (signupForm.password !== signupForm.confirmPassword) {
            newErrors.confirmPassword = t.passwordsDontMatch;
          }
          
          if (!signupForm.class.trim()) {
            newErrors.class = t.fieldRequired;
          }
          
          setErrors(newErrors);
          return Object.keys(newErrors).length === 0;
        }, [signupForm, users, t]);

        const handleSignup = useCallback((e) => {
          e.preventDefault();
          if (validateForm()) {
            setSignupStep(2);
            
            // Generate verification code (in a real app, this would be sent via email)
            const code = Math.floor(100000 + Math.random() * 900000).toString();
            
            // Create new user
            const newUser = {
              id: users.length + 1,
              ...signupForm,
              lastActive: new Date().toISOString().split('T')[0],
              emailVerified: false,
              verificationCode: code,
              progress: signupForm.role === "student" ? {
                completedUnits: 0,
                quizAverage: 0,
                assignmentsCompleted: 0
              } : undefined
            };
            
            setUsers(prev => [...prev, newUser]);
            alert(`${t.emailSent}\n\n${t.codeSent} ${signupForm.email}\n\n${t.pleaseCheck}`);
          }
        }, [signupForm, validateForm, users, t]);

        const handleVerification = useCallback((e) => {
          e.preventDefault();
          setIsVerifying(true);
          
          // Find user by email
          const userToVerify = users.find(u => u.email === signupForm.email);
          
          if (userToVerify && userToVerify.verificationCode === verificationCode) {
            // Update user to verified
            setUsers(prev => prev.map(u => 
              u.email === signupForm.email 
                ? { ...u, emailVerified: true } 
                : u
            ));
            
            setTimeout(() => {
              setIsVerifying(false);
              alert(t.verificationSuccess);
              setCurrentPage("login");
              setSignupStep(1);
              // Reset forms
              setSignupForm({ 
                name: "", 
                email: "", 
                username: "", 
                password: "", 
                confirmPassword: "", 
                role: "student", 
                class: "" 
              });
              setVerificationCode("");
            }, 1000);
          } else {
            setTimeout(() => {
              setIsVerifying(false);
              alert(t.verificationFailed);
            }, 1000);
          }
        }, [signupForm.email, verificationCode, users, t]);

        const resendVerificationCode = useCallback(() => {
          const userToResend = users.find(u => u.email === signupForm.email);
          if (userToResend) {
            // Generate new code
            const newCode = Math.floor(100000 + Math.random() * 900000).toString();
            
            setUsers(prev => prev.map(u => 
              u.email === signupForm.email 
                ? { ...u, verificationCode: newCode } 
                : u
            ));
            
            alert(t.resendSuccess);
          } else {
            alert(t.resendError);
          }
        }, [signupForm.email, users, t]);

        // Focus management for signup inputs
        useEffect(() => {
          const timer = setTimeout(() => {
            if (signupNameRef.current && !signupForm.name) {
              signupNameRef.current.focus();
            }
          }, 100);
          return () => clearTimeout(timer);
        }, []);

        return (
          <div style={{
            display: "flex",
            alignItems: "center",
            justifyContent: "center",
            minHeight: "100vh",
            background: "#e8f5e8",
            padding: "20px"
          }}>
            <div style={{
              background: "white",
              borderRadius: "12px",
              padding: "40px",
              width: "100%",
              maxWidth: "500px",
              boxShadow: "0 8px 25px rgba(0, 0, 0, 0.1)"
            }}>
              {signupStep === 1 ? (
                <>
                  <div style={{
                    textAlign: "center",
                    marginBottom: "30px"
                  }}>
                    <div style={{
                      fontSize: "60px",
                      marginBottom: "20px"
                    }}>
                      ✍️
                    </div>
                    <h2 style={{
                      fontSize: "28px",
                      fontWeight: "700",
                      color: "#333",
                      margin: "0"
                    }}>
                      {signupForm.role === "student" ? t.signupAsStudent : t.signupAsTeacher}
                    </h2>
                    <p style={{
                      color: "#666",
                      marginTop: "10px"
                    }}>
                      {t.createAccount}
                    </p>
                  </div>
                  
                  <form onSubmit={handleSignup} style={{
                    spaceY: "20px"
                  }}>
                    <div style={{
                      display: "flex",
                      gap: "10px",
                      marginBottom: "20px"
                    }}>
                      <button 
                        type="button"
                        onClick={() => updateSignupForm("role", "student")}
                        style={{
                          flex: 1,
                          background: signupForm.role === "student" ? "#2196f3" : "#e0e0e0",
                          color: signupForm.role === "student" ? "white" : "#333",
                          border: "none",
                          padding: "10px",
                          borderRadius: "8px",
                          fontWeight: "500",
                          cursor: "pointer"
                        }}
                      >
                        {t.student}
                      </button>
                      <button 
                        type="button"
                        onClick={() => updateSignupForm("role", "teacher")}
                        style={{
                          flex: 1,
                          background: signupForm.role === "teacher" ? "#4caf50" : "#e0e0e0",
                          color: signupForm.role === "teacher" ? "white" : "#333",
                          border: "none",
                          padding: "10px",
                          borderRadius: "8px",
                          fontWeight: "500",
                          cursor: "pointer"
                        }}
                      >
                        {t.teacher}
                      </button>
                    </div>
                    
                    <div style={{
                      marginBottom: "20px"
                    }}>
                      <label style={{
                        display: "block",
                        fontSize: "14px",
                        fontWeight: "500",
                        color: "#333",
                        marginBottom: "8px"
                      }}>
                        {t.name}
                      </label>
                      <input
                        ref={signupNameRef}
                        type="text"
                        value={signupForm.name}
                        onChange={(e) => updateSignupForm("name", e.target.value)}
                        style={{
                          width: "100%",
                          border: "2px solid " + (errors.name ? "#f44336" : "#ddd"),
                          borderRadius: "8px",
                          padding: "12px",
                          fontSize: "16px",
                          outline: "none"
                        }}
                        placeholder="Enter your full name"
                        autoComplete="name"
                      />
                      {errors.name && (
                        <p style={{
                          color: "#f44336",
                          fontSize: "12px",
                          marginTop: "4px"
                        }}>
                          {errors.name}
                        </p>
                      )}
                    </div>
                    
                    <div style={{
                      marginBottom: "20px"
                    }}>
                      <label style={{
                        display: "block",
                        fontSize: "14px",
                        fontWeight: "500",
                        color: "#333",
                        marginBottom: "8px"
                      }}>
                        {t.email}
                      </label>
                      <input
                        ref={signupEmailRef}
                        type="email"
                        value={signupForm.email}
                        onChange={(e) => updateSignupForm("email", e.target.value)}
                        style={{
                          width: "100%",
                          border: "2px solid " + (errors.email ? "#f44336" : "#ddd"),
                          borderRadius: "8px",
                          padding: "12px",
                          fontSize: "16px",
                          outline: "none"
                        }}
                        placeholder="Enter your email address"
                        autoComplete="email"
                      />
                      {errors.email && (
                        <p style={{
                          color: "#f44336",
                          fontSize: "12px",
                          marginTop: "4px"
                        }}>
                          {errors.email}
                        </p>
                      )}
                    </div>
                    
                    <div style={{
                      marginBottom: "20px"
                    }}>
                      <label style={{
                        display: "block",
                        fontSize: "14px",
                        fontWeight: "500",
                        color: "#333",
                        marginBottom: "8px"
                      }}>
                        {t.username}
                      </label>
                      <input
                        ref={signupUsernameRef}
                        type="text"
                        value={signupForm.username}
                        onChange={(e) => updateSignupForm("username", e.target.value)}
                        style={{
                          width: "100%",
                          border: "2px solid " + (errors.username ? "#f44336" : "#ddd"),
                          borderRadius: "8px",
                          padding: "12px",
                          fontSize: "16px",
                          outline: "none"
                        }}
                        placeholder="Choose a username"
                        autoComplete="username"
                      />
                      {errors.username && (
                        <p style={{
                          color: "#f44336",
                          fontSize: "12px",
                          marginTop: "4px"
                        }}>
                          {errors.username}
                        </p>
                      )}
                    </div>
                    
                    <div style={{
                      marginBottom: "20px"
                    }}>
                      <label style={{
                        display: "block",
                        fontSize: "14px",
                        fontWeight: "500",
                        color: "#333",
                        marginBottom: "8px"
                      }}>
                        {t.password}
                      </label>
                      <div style={{
                        position: "relative"
                      }}>
                        <input
                          ref={signupPasswordRef}
                          type={showPassword ? "text" : "password"}
                          value={signupForm.password}
                          onChange={(e) => updateSignupForm("password", e.target.value)}
                          style={{
                            width: "100%",
                            border: "2px solid " + (errors.password ? "#f44336" : "#ddd"),
                            borderRadius: "8px",
                            padding: "12px",
                            fontSize: "16px",
                            outline: "none",
                            paddingRight: "40px"
                          }}
                          placeholder="Create a password"
                          autoComplete="new-password"
                        />
                        <button
                          type="button"
                          onClick={() => setShowPassword(!showPassword)}
                          style={{
                            position: "absolute",
                            right: "12px",
                            top: "50%",
                            transform: "translateY(-50%)",
                            background: "none",
                            border: "none",
                            color: "#666",
                            cursor: "pointer"
                          }}
                        >
                          {showPassword ? "👁️" : "👁️‍🗨️"}
                        </button>
                      </div>
                      {errors.password && (
                        <p style={{
                          color: "#f44336",
                          fontSize: "12px",
                          marginTop: "4px"
                        }}>
                          {errors.password}
                        </p>
                      )}
                    </div>
                    
                    <div style={{
                      marginBottom: "20px"
                    }}>
                      <label style={{
                        display: "block",
                        fontSize: "14px",
                        fontWeight: "500",
                        color: "#333",
                        marginBottom: "8px"
                      }}>
                        {t.confirmPassword}
                      </label>
                      <div style={{
                        position: "relative"
                      }}>
                        <input
                          ref={signupConfirmPasswordRef}
                          type={showConfirmPassword ? "text" : "password"}
                          value={signupForm.confirmPassword}
                          onChange={(e) => updateSignupForm("confirmPassword", e.target.value)}
                          style={{
                            width: "100%",
                            border: "2px solid " + (errors.confirmPassword ? "#f44336" : "#ddd"),
                            borderRadius: "8px",
                            padding: "12px",
                            fontSize: "16px",
                            outline: "none",
                            paddingRight: "40px"
                          }}
                          placeholder="Confirm your password"
                          autoComplete="new-password"
                        />
                        <button
                          type="button"
                          onClick={() => setShowConfirmPassword(!showConfirmPassword)}
                          style={{
                            position: "absolute",
                            right: "12px",
                            top: "50%",
                            transform: "translateY(-50%)",
                            background: "none",
                            border: "none",
                            color: "#666",
                            cursor: "pointer"
                          }}
                        >
                          {showConfirmPassword ? "👁️" : "👁️‍🗨️"}
                        </button>
                      </div>
                      {errors.confirmPassword && (
                        <p style={{
                          color: "#f44336",
                          fontSize: "12px",
                          marginTop: "4px"
                        }}>
                          {errors.confirmPassword}
                        </p>
                      )}
                    </div>
                    
                    <div style={{
                      marginBottom: "20px"
                    }}>
                      <label style={{
                        display: "block",
                        fontSize: "14px",
                        fontWeight: "500",
                        color: "#333",
                        marginBottom: "8px"
                      }}>
                        {signupForm.role === "student" ? t.studentClass : t.teacherClass}
                      </label>
                      <input
                        ref={signupClassRef}
                        type="text"
                        value={signupForm.class}
                        onChange={(e) => updateSignupForm("class", e.target.value)}
                        style={{
                          width: "100%",
                          border: "2px solid " + (errors.class ? "#f44336" : "#ddd"),
                          borderRadius: "8px",
                          padding: "12px",
                          fontSize: "16px",
                          outline: "none"
                        }}
                        placeholder={signupForm.role === "student" ? "e.g., Grade 7" : "e.g., Grade 7-9"}
                      />
                      {errors.class && (
                        <p style={{
                          color: "#f44336",
                          fontSize: "12px",
                          marginTop: "4px"
                        }}>
                          {errors.class}
                        </p>
                      )}
                    </div>
                    
                    <button
                      type="submit"
                      style={{
                        width: "100%",
                        background: "linear-gradient(135deg, #4caf50, #66bb6a)",
                        color: "white",
                        border: "none",
                        padding: "12px",
                        borderRadius: "8px",
                        fontSize: "16px",
                        fontWeight: "600",
                        cursor: "pointer"
                      }}
                    >
                      {t.continue}
                    </button>
                  </form>
                  
                  <div style={{
                    textAlign: "center",
                    marginTop: "20px"
                  }}>
                    <p style={{
                      color: "#666",
                      fontSize: "14px"
                    }}>
                      {t.alreadyHaveAccount}{" "}
                      <button 
                        onClick={() => navigateTo("login")}
                        style={{
                          background: "none",
                          border: "none",
                          color: "#2196f3",
                          fontWeight: "500",
                          cursor: "pointer"
                        }}
                      >
                        {t.login}
                      </button>
                    </p>
                  </div>
                </>
              ) : (
                <>
                  <div style={{
                    textAlign: "center",
                    marginBottom: "30px"
                  }}>
                    <div style={{
                      fontSize: "60px",
                      marginBottom: "20px"
                    }}>
                      ✉️
                    </div>
                    <h2 style={{
                      fontSize: "28px",
                      fontWeight: "700",
                      color: "#333",
                      margin: "0"
                    }}>
                      {t.emailVerification}
                    </h2>
                    <p style={{
                      color: "#666",
                      marginTop: "10px"
                    }}>
                      {t.verificationSent}
                    </p>
                  </div>
                  
                  <form onSubmit={handleVerification} style={{
                    spaceY: "20px"
                  }}>
                    <div style={{
                      marginBottom: "20px",
                      textAlign: "center"
                    }}>
                      <p style={{
                        color: "#666",
                        fontSize: "14px",
                        marginBottom: "15px"
                      }}>
                        {t.codeSent} <strong>{signupForm.email}</strong>
                      </p>
                      <p style={{
                        color: "#666",
                        fontSize: "14px",
                        marginBottom: "20px"
                      }}>
                        {t.pleaseCheck}
                      </p>
                    </div>
                    
                    <div style={{
                      marginBottom: "20px"
                    }}>
                      <label style={{
                        display: "block",
                        fontSize: "14px",
                        fontWeight: "500",
                        color: "#333",
                        marginBottom: "8px",
                        textAlign: "center"
                      }}>
                        {t.verificationCode}
                      </label>
                      <input
                        type="text"
                        value={verificationCode}
                        onChange={(e) => setVerificationCode(e.target.value)}
                        style={{
                          width: "100%",
                          border: "2px solid #ddd",
                          borderRadius: "8px",
                          padding: "12px",
                          fontSize: "16px",
                          outline: "none",
                          textAlign: "center",
                          letterSpacing: "8px"
                        }}
                        placeholder="123456"
                        maxLength="6"
                        required
                      />
                    </div>
                    
                    <button
                      type="submit"
                      disabled={isVerifying}
                      style={{
                        width: "100%",
                        background: isVerifying ? "#9e9e9e" : "linear-gradient(135deg, #4caf50, #66bb6a)",
                        color: "white",
                        border: "none",
                        padding: "12px",
                        borderRadius: "8px",
                        fontSize: "16px",
                        fontWeight: "600",
                        cursor: isVerifying ? "not-allowed" : "pointer"
                      }}
                    >
                      {isVerifying ? t.verificationInProgress : t.verify}
                    </button>
                    
                    <div style={{
                      textAlign: "center",
                      marginTop: "15px"
                    }}>
                      <button 
                        type="button"
                        onClick={resendVerificationCode}
                        style={{
                          background: "none",
                          border: "none",
                          color: "#2196f3",
                          fontWeight: "500",
                          cursor: "pointer"
                        }}
                      >
                        {t.resendCode}
                      </button>
                    </div>
                  </form>
                </>
              )}
            </div>
          </div>
        );
      };

      // Student Dashboard
      const StudentDashboard = () => (
        <div style={{
          maxWidth: "1200px",
          margin: "0 auto",
          padding: "20px",
          fontFamily: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"
        }}>
          <div style={{
            background: "white",
            borderRadius: "12px",
            padding: "30px",
            marginBottom: "20px",
            boxShadow: "0 4px 15px rgba(0, 0, 0, 0.1)"
          }}>
            <h2 style={{
              fontSize: "28px",
              fontWeight: "700",
              color: "#333",
              marginBottom: "20px"
            }}>
              {t.studentDashboard}
            </h2>
            
            <div style={{
              display: "grid",
              gridTemplateColumns: "1fr 1fr 1fr",
              gap: "20px",
              marginBottom: "30px"
            }}>
              <div style={{
                background: "#e3f2fd",
                padding: "20px",
                borderRadius: "8px",
                textAlign: "center"
              }}>
                <div style={{
                  fontSize: "24px",
                  fontWeight: "700",
                  color: "#1976d2",
                  marginBottom: "5px"
                }}>
                  {user?.progress?.completedUnits || 0}
                </div>
                <div style={{
                  fontSize: "14px",
                  color: "#1976d2"
                }}>
                  {t.completedUnits}
                </div>
              </div>
              
              <div style={{
                background: "#e8f5e8",
                padding: "20px",
                borderRadius: "8px",
                textAlign: "center"
              }}>
                <div style={{
                  fontSize: "24px",
                  fontWeight: "700",
                  color: "#388e3c",
                  marginBottom: "5px"
                }}>
                  {user?.progress?.quizAverage || 0}%
                </div>
                <div style={{
                  fontSize: "14px",
                  color: "#388e3c"
                }}>
                  {t.quizAverage}
                </div>
              </div>
              
              <div style={{
                background: "#fff3e0",
                padding: "20px",
                borderRadius: "8px",
                textAlign: "center"
              }}>
                <div style={{
                  fontSize: "24px",
                  fontWeight: "700",
                  color: "#f57c00",
                  marginBottom: "5px"
                }}>
                  {user?.progress?.assignmentsCompleted || 0}
                </div>
                <div style={{
                  fontSize: "14px",
                  color: "#f57c00"
                }}>
                  {t.assignmentsCompleted}
                </div>
              </div>
            </div>
            
            <div style={{
              display: "grid",
              gridTemplateColumns: "1fr 1fr",
              gap: "20px"
            }}>
              <div>
                <h3 style={{
                  fontSize: "18px",
                  fontWeight: "600",
                  color: "#333",
                  marginBottom: "15px"
                }}>
                  {t.profile}
                </h3>
                <div style={{
                  spaceY: "10px"
                }}>
                  <div style={{
                    display: "flex",
                    justifyContent: "space-between",
                    padding: "8px 0",
                    borderBottom: "1px solid #eee"
                  }}>
                    <span style={{color: "#666"}}>{t.name}</span>
                    <span style={{fontWeight: "500"}}>{user?.name}</span>
                  </div>
                  <div style={{
                    display: "flex",
                    justifyContent: "space-between",
                    padding: "8px 0",
                    borderBottom: "1px solid #eee"
                  }}>
                    <span style={{color: "#666"}}>{t.email}</span>
                    <span style={{fontWeight: "500"}}>{user?.email}</span>
                  </div>
                  <div style={{
                    display: "flex",
                    justifyContent: "space-between",
                    padding: "8px 0",
                    borderBottom: "1px solid #eee"
                  }}>
                    <span style={{color: "#666"}}>{t.class}</span>
                    <span style={{fontWeight: "500"}}>{user?.class}</span>
                  </div>
                  <div style={{
                    display: "flex",
                    justifyContent: "space-between",
                    padding: "8px 0",
                    borderBottom: "1px solid #eee"
                  }}>
                    <span style={{color: "#666"}}>{t.role}</span>
                    <span style={{fontWeight: "500", textTransform: "capitalize"}}>{user?.role}</span>
                  </div>
                  <div style={{
                    display: "flex",
                    justifyContent: "space-between",
                    padding: "8px 0"
                  }}>
                    <span style={{color: "#666"}}>{t.lastActive}</span>
                    <span style={{fontWeight: "500"}}>{user?.lastActive}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          {/* Student Classes Section */}
          <div style={{
            background: "white",
            borderRadius: "12px",
            padding: "30px",
            marginBottom: "20px",
            boxShadow: "0 4px 15px rgba(0, 0, 0, 0.1)"
          }}>
            <div style={{
              display: "flex",
              justifyContent: "space-between",
              alignItems: "center",
              marginBottom: "20px"
            }}>
              <h3 style={{
                fontSize: "24px",
                fontWeight: "700",
                color: "#333",
                margin: "0"
              }}>
                {t.myClasses}
              </h3>
              <button 
                onClick={() => navigateTo("join-class")}
                style={{
                  background: "linear-gradient(135deg, #4caf50, #66bb6a)",
                  color: "white",
                  border: "none",
                  padding: "10px 20px",
                  borderRadius: "8px",
                  fontSize: "16px",
                  fontWeight: "600",
                  cursor: "pointer"
                }}
              >
                {t.joinClass}
              </button>
            </div>

            {studentClasses.length === 0 ? (
              <div style={{
                textAlign: "center",
                padding: "40px",
                color: "#666"
              }}>
                <div style={{
                  fontSize: "60px",
                  marginBottom: "15px"
                }}>
                  🏫
                </div>
                <p>{t.noClasses}</p>
              </div>
            ) : (
              <div style={{
                spaceY: "20px"
              }}>
                {studentClasses.map(cls => (
                  <div key={cls.id} style={{
                    border: "2px solid #eee",
                    borderRadius: "12px",
                    padding: "20px",
                    transition: "border-color 0.3s ease"
                  }}>
                    <div style={{
                      display: "flex",
                      alignItems: "center",
                      justifyContent: "space-between",
                      marginBottom: "15px"
                    }}>
                      <div>
                        <h4 style={{
                          fontSize: "20px",
                          fontWeight: "700",
                          color: "#333",
                          margin: "0"
                        }}>
                          {cls.name}
                        </h4>
                        <div style={{
                          display: "flex",
                          gap: "15px",
                          marginTop: "5px"
                        }}>
                          <span style={{
                            fontSize: "14px",
                            color: "#666"
                          }}>
                            {t.teacher}: <strong>{cls.teacherName}</strong>
                          </span>
                          <span style={{
                            fontSize: "14px",
                            color: "#666"
                          }}>
                            {t.classCode}: <strong>{cls.code}</strong>
                          </span>
                        </div>
                      </div>
                      <button 
                        onClick={() => navigateTo(`class-details-${cls.id}`)}
                        style={{
                          background: "#2196f3",
                          color: "white",
                          border: "none",
                          padding: "8px 16px",
                          borderRadius: "8px",
                          fontSize: "14px",
                          fontWeight: "600",
                          cursor: "pointer"
                        }}
                      >
                        {t.classDetails}
                      </button>
                    </div>
                    
                    <div style={{
                      display: "flex",
                      justifyContent: "space-between",
                      alignItems: "center",
                      paddingTop: "15px",
                      borderTop: "1px solid #eee"
                    }}>
                      <div style={{
                        fontSize: "14px",
                        color: "#666"
                      }}>
                        {t.joinedDate}: <strong>{cls.joinedDate}</strong>
                      </div>
                      <button 
                        onClick={() => leaveClass(cls.id)}
                        style={{
                          background: "#f44336",
                          color: "white",
                          border: "none",
                          padding: "6px 12px",
                          borderRadius: "6px",
                          fontSize: "14px",
                          fontWeight: "600",
                          cursor: "pointer"
                        }}
                      >
                        {t.leaveClass}
                      </button>
                    </div>
                  </div>
                ))}
              </div>
            )}
          </div>
        </div>
      );

      // Teacher Dashboard
      const TeacherDashboard = () => (
        <div style={{
          maxWidth: "1200px",
          margin: "0 auto",
          padding: "20px",
          fontFamily: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"
        }}>
          <div style={{
            background: "white",
            borderRadius: "12px",
            padding: "30px",
            marginBottom: "20px",
            boxShadow: "0 4px 15px rgba(0, 0, 0, 0.1)"
          }}>
            <h2 style={{
              fontSize: "28px",
              fontWeight: "700",
              color: "#333",
              marginBottom: "20px"
            }}>
              {t.teacherDashboard}
            </h2>
            
            <div style={{
              display: "grid",
              gridTemplateColumns: "1fr 1fr 1fr",
              gap: "20px",
              marginBottom: "30px"
            }}>
              <div style={{
                background: "#f3e5f5",
                padding: "20px",
                borderRadius: "8px",
                textAlign: "center"
              }}>
                <div style={{
                  fontSize: "24px",
                  fontWeight: "700",
                  color: "#7b1fa2",
                  marginBottom: "5px"
                }}>
                  {teacherClasses.length}
                </div>
                <div style={{
                  fontSize: "14px",
                  color: "#7b1fa2"
                }}>
                  {t.myClasses}
                </div>
              </div>
              
              <div style={{
                background: "#ffecb3",
                padding: "20px",
                borderRadius: "8px",
                textAlign: "center"
              }}>
                <div style={{
                  fontSize: "24px",
                  fontWeight: "700",
                  color: "#ff8f00",
                  marginBottom: "5px"
                }}>
                  {teacherClasses.reduce((total, cls) => total + cls.students.length, 0)}
                </div>
                <div style={{
                  fontSize: "14px",
                  color: "#ff8f00"
                }}>
                  {t.students}
                </div>
              </div>
              
              <div style={{
                background: "#e8f5e8",
                padding: "20px",
                borderRadius: "8px",
                textAlign: "center"
              }}>
                <div style={{
                  fontSize: "24px",
                  fontWeight: "700",
                  color: "#388e3c",
                  marginBottom: "5px"
                }}>
                  {teacherClasses.reduce((total, cls) => total + cls.materials.length, 0)}
                </div>
                <div style={{
                  fontSize: "14px",
                  color: "#388e3c"
                }}>
                  {t.materials}
                </div>
              </div>
            </div>
            
            <div style={{
              display: "grid",
              gridTemplateColumns: "1fr 1fr",
              gap: "20px"
            }}>
              <div>
                <h3 style={{
                  fontSize: "18px",
                  fontWeight: "600",
                  color: "#333",
                  marginBottom: "15px"
                }}>
                  {t.profile}
                </h3>
                <div style={{
                  spaceY: "10px"
                }}>
                  <div style={{
                    display: "flex",
                    justifyContent: "space-between",
                    padding: "8px 0",
                    borderBottom: "1px solid #eee"
                  }}>
                    <span style={{color: "#666"}}>{t.name}</span>
                    <span style={{fontWeight: "500"}}>{user?.name}</span>
                  </div>
                  <div style={{
                    display: "flex",
                    justifyContent: "space-between",
                    padding: "8px 0",
                    borderBottom: "1px solid #eee"
                  }}>
                    <span style={{color: "#666"}}>{t.email}</span>
                    <span style={{fontWeight: "500"}}>{user?.email}</span>
                  </div>
                  <div style={{
                    display: "flex",
                    justifyContent: "space-between",
                    padding: "8px 0",
                    borderBottom: "1px solid #eee"
                  }}>
                    <span style={{color: "#666"}}>{t.class}</span>
                    <span style={{fontWeight: "500"}}>{user?.class}</span>
                  </div>
                  <div style={{
                    display: "flex",
                    justifyContent: "space-between",
                    padding: "8px 0",
                    borderBottom: "1px solid #eee"
                  }}>
                    <span style={{color: "#666"}}>{t.role}</span>
                    <span style={{fontWeight: "500", textTransform: "capitalize"}}>{user?.role}</span>
                  </div>
                  <div style={{
                    display: "flex",
                    justifyContent: "space-between",
                    padding: "8px 0"
                  }}>
                    <span style={{color: "#666"}}>{t.lastActive}</span>
                    <span style={{fontWeight: "500"}}>{user?.lastActive}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          {/* Teacher Classes Section */}
          <div style={{
            background: "white",
            borderRadius: "12px",
            padding: "30px",
            marginBottom: "20px",
            boxShadow: "0 4px 15px rgba(0, 0, 0, 0.1)"
          }}>
            <div style={{
              display: "flex",
              justifyContent: "space-between",
              alignItems: "center",
              marginBottom: "20px"
            }}>
              <h3 style={{
                fontSize: "24px",
                fontWeight: "700",
                color: "#333",
                margin: "0"
              }}>
                {t.myClasses}
              </h3>
              <button 
                onClick={() => navigateTo("create-class")}
                style={{
                  background: "linear-gradient(135deg, #4caf50, #66bb6a)",
                  color: "white",
                  border: "none",
                  padding: "10px 20px",
                  borderRadius: "8px",
                  fontSize: "16px",
                  fontWeight: "600",
                  cursor: "pointer"
                }}
              >
                {t.createClass}
              </button>
            </div>

            {teacherClasses.length === 0 ? (
              <div style={{
                textAlign: "center",
                padding: "40px",
                color: "#666"
              }}>
                <div style={{
                  fontSize: "60px",
                  marginBottom: "15px"
                }}>
                  🏫
                </div>
                <p>{t.noClasses}</p>
              </div>
            ) : (
              <div style={{
                spaceY: "20px"
              }}>
                {teacherClasses.map(cls => (
                  <div key={cls.id} style={{
                    border: "2px solid #eee",
                    borderRadius: "12px",
                    padding: "20px",
                    transition: "border-color 0.3s ease"
                  }}>
                    <div style={{
                      display: "flex",
                      alignItems: "center",
                      justifyContent: "space-between",
                      marginBottom: "15px"
                    }}>
                      <div>
                        <h4 style={{
                          fontSize: "20px",
                          fontWeight: "700",
                          color: "#333",
                          margin: "0"
                        }}>
                          {cls.name}
                        </h4>
                        <div style={{
                          display: "flex",
                          gap: "15px",
                          marginTop: "5px"
                        }}>
                          <span style={{
                            fontSize: "14px",
                            color: "#666"
                          }}>
                            {t.classCode}: <strong>{cls.code}</strong>
                          </span>
                          <span style={{
                            fontSize: "14px",
                            color: "#666"
                          }}>
                            {cls.students.length} {t.students}
                          </span>
                        </div>
                      </div>
                      <div style={{
                        display: "flex",
                        gap: "10px"
                      }}>
                        <button 
                          onClick={() => navigateTo(`class-details-${cls.id}`)}
                          style={{
                            background: "#2196f3",
                            color: "white",
                            border: "none",
                            padding: "8px 16px",
                            borderRadius: "8px",
                            fontSize: "14px",
                            fontWeight: "600",
                            cursor: "pointer"
                          }}
                        >
                          {t.classDetails}
                        </button>
                        <button 
                          onClick={() => startEditClass(cls)}
                          style={{
                            background: "#ff9800",
                            color: "white",
                            border: "none",
                            padding: "8px 16px",
                            borderRadius: "8px",
                            fontSize: "14px",
                            fontWeight: "600",
                            cursor: "pointer"
                          }}
                        >
                          {t.editClass}
                        </button>
                        <button 
                          onClick={() => deleteClass(cls.id)}
                          style={{
                            background: "#f44336",
                            color: "white",
                            border: "none",
                            padding: "8px 16px",
                            borderRadius: "8px",
                            fontSize: "14px",
                            fontWeight: "600",
                            cursor: "pointer"
                          }}
                        >
                          {t.deleteClass}
                        </button>
                      </div>
                    </div>
                    
                    <div style={{
                      display: "flex",
                      justifyContent: "space-between",
                      alignItems: "center",
                      paddingTop: "15px",
                      borderTop: "1px solid #eee"
                    }}>
                      <div style={{
                        fontSize: "14px",
                        color: "#666"
                      }}>
                        {t.createdAt}: <strong>{cls.createdAt}</strong>
                      </div>
                      <div style={{
                        fontSize: "14px",
                        color: "#666"
                      }}>
                        {t.updatedAt}: <strong>{cls.updatedAt}</strong>
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            )}
          </div>
        </div>
      );

      // Create Class Page
      const CreateClassPage = () => {
        return (
          <div style={{
            maxWidth: "800px",
            margin: "0 auto",
            padding: "20px",
            fontFamily: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"
          }}>
            <div style={{
              background: "white",
              borderRadius: "12px",
              padding: "40px",
              marginBottom: "20px",
              boxShadow: "0 4px 15px rgba(0, 0, 0, 0.1)"
            }}>
              <h2 style={{
                fontSize: "28px",
                fontWeight: "700",
                color: "#333",
                marginBottom: "30px",
                textAlign: "center"
              }}>
                {t.createClass}
              </h2>
              
              <form onSubmit={(e) => { e.preventDefault(); createClass(); }} style={{
                spaceY: "20px"
              }}>
                <div style={{
                  marginBottom: "20px"
                }}>
                  <label style={{
                    display: "block",
                    fontSize: "14px",
                    fontWeight: "500",
                    color: "#333",
                    marginBottom: "8px"
                  }}>
                    {t.className}
                  </label>
                  <input 
                    type="text" 
                    value={classForm.name} 
                    onChange={(e) => updateClassForm("name", e.target.value)}
                    placeholder="e.g., Biology 101"
                    style={{
                      width: "100%",
                      border: "2px solid #ddd",
                      borderRadius: "8px",
                      padding: "12px",
                      fontSize: "16px"
                    }}
                    required
                  />
                </div>
                
                <div style={{
                  marginBottom: "30px"
                }}>
                  <label style={{
                    display: "block",
                    fontSize: "14px",
                    fontWeight: "500",
                    color: "#333",
                    marginBottom: "8px"
                  }}>
                    {t.classCode}
                  </label>
                  <input 
                    type="text" 
                    value={classForm.code} 
                    onChange={(e) => updateClassForm("code", e.target.value)}
                    placeholder="e.g., BIO101-2024"
                    style={{
                      width: "100%",
                      border: "2px solid #ddd",
                      borderRadius: "8px",
                      padding: "12px",
                      fontSize: "16px"
                    }}
                    required
                  />
                </div>
                
                <div style={{
                  display: "flex",
                  justifyContent: "center",
                  gap: "20px"
                }}>
                  <button 
                    type="button"
                    onClick={() => navigateTo("teacher-dashboard")}
                    style={{
                      background: "#9e9e9e",
                      color: "white",
                      border: "none",
                      padding: "12px 30px",
                      borderRadius: "8px",
                      fontSize: "16px",
                      fontWeight: "600",
                      cursor: "pointer"
                    }}
                  >
                    {t.cancel}
                  </button>
                  <button 
                    type="submit"
                    style={{
                      background: "linear-gradient(135deg, #4caf50, #66bb6a)",
                      color: "white",
                      border: "none",
                      padding: "12px 30px",
                      borderRadius: "8px",
                      fontSize: "16px",
                      fontWeight: "600",
                      cursor: "pointer"
                    }}
                  >
                    {t.createClass}
                  </button>
                </div>
              </form>
            </div>
          </div>
        );
      };

      // Edit Class Page
      const EditClassPage = () => {
        if (!selectedClass) {
          navigateTo("teacher-dashboard");
          return null;
        }

        return (
          <div style={{
            maxWidth: "800px",
            margin: "0 auto",
            padding: "20px",
            fontFamily: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"
          }}>
            <div style={{
              background: "white",
              borderRadius: "12px",
              padding: "40px",
              marginBottom: "20px",
              boxShadow: "0 4px 15px rgba(0, 0, 0, 0.1)"
            }}>
              <h2 style={{
                fontSize: "28px",
                fontWeight: "700",
                color: "#333",
                marginBottom: "30px",
                textAlign: "center"
              }}>
                {t.editClass}
              </h2>
              
              <form onSubmit={(e) => { e.preventDefault(); updateClass(); }} style={{
                spaceY: "20px"
              }}>
                <div style={{
                  marginBottom: "20px"
                }}>
                  <label style={{
                    display: "block",
                    fontSize: "14px",
                    fontWeight: "500",
                    color: "#333",
                    marginBottom: "8px"
                  }}>
                    {t.className}
                  </label>
                  <input 
                    type="text" 
                    value={classForm.name} 
                    onChange={(e) => updateClassForm("name", e.target.value)}
                    style={{
                      width: "100%",
                      border: "2px solid #ddd",
                      borderRadius: "8px",
                      padding: "12px",
                      fontSize: "16px"
                    }}
                    required
                  />
                </div>
                
                <div style={{
                  marginBottom: "30px"
                }}>
                  <label style={{
                    display: "block",
                    fontSize: "14px",
                    fontWeight: "500",
                    color: "#333",
                    marginBottom: "8px"
                  }}>
                    {t.classCode}
                  </label>
                  <input 
                    type="text" 
                    value={classForm.code} 
                    onChange={(e) => updateClassForm("code", e.target.value)}
                    style={{
                      width: "100%",
                      border: "2px solid #ddd",
                      borderRadius: "8px",
                      padding: "12px",
                      fontSize: "16px"
                    }}
                    required
                  />
                </div>
                
                <div style={{
                  display: "flex",
                  justifyContent: "center",
                  gap: "20px"
                }}>
                  <button 
                    type="button"
                    onClick={cancelEditClass}
                    style={{
                      background: "#9e9e9e",
                      color: "white",
                      border: "none",
                      padding: "12px 30px",
                      borderRadius: "8px",
                      fontSize: "16px",
                      fontWeight: "600",
                      cursor: "pointer"
                    }}
                  >
                    {t.cancel}
                  </button>
                  <button 
                    type="submit"
                    style={{
                      background: "linear-gradient(135deg, #4caf50, #66bb6a)",
                      color: "white",
                      border: "none",
                      padding: "12px 30px",
                      borderRadius: "8px",
                      fontSize: "16px",
                      fontWeight: "600",
                      cursor: "pointer"
                    }}
                  >
                    {t.update}
                  </button>
                </div>
              </form>
            </div>
          </div>
        );
      };

      // Class Details Page
      const ClassDetailsPage = () => {
        const classId = parseInt(currentPage.split('-')[2]);
        const classObj = [...teacherClasses, ...studentClasses].find(c => c.id === classId);
        
        if (!classObj) {
          navigateTo(user?.role === "teacher" ? "teacher-dashboard" : "student-dashboard");
          return null;
        }

        const isTeacher = user?.role === "teacher" && teacherClasses.some(c => c.id === classId);
        const classData = teacherClasses.find(c => c.id === classId) || classObj;

        return (
          <div style={{
            maxWidth: "1200px",
            margin: "0 auto",
            padding: "20px",
            fontFamily: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"
          }}>
            <div style={{
              background: "white",
              borderRadius: "12px",
              padding: "30px",
              marginBottom: "20px",
              boxShadow: "0 4px 15px rgba(0, 0, 0, 0.1)"
            }}>
              <div style={{
                display: "flex",
                justifyContent: "space-between",
                alignItems: "center",
                marginBottom: "20px"
              }}>
                <div>
                  <h2 style={{
                    fontSize: "28px",
                    fontWeight: "700",
                    color: "#333",
                    margin: "0"
                  }}>
                    {classData.name}
                  </h2>
                  <div style={{
                    display: "flex",
                    gap: "15px",
                    marginTop: "5px"
                  }}>
                    <span style={{
                      fontSize: "14px",
                      color: "#666"
                    }}>
                      {t.classCode}: <strong>{classData.code}</strong>
                    </span>
                    <span style={{
                      fontSize: "14px",
                      color: "#666"
                    }}>
                      {t.teacher}: <strong>{classData.teacherName}</strong>
                    </span>
                  </div>
                </div>
                <button 
                  onClick={() => navigateTo(user?.role === "teacher" ? "teacher-dashboard" : "student-dashboard")}
                  style={{
                    background: "#9e9e9e",
                    color: "white",
                    border: "none",
                    padding: "10px 20px",
                    borderRadius: "8px",
                    fontSize: "16px",
                    fontWeight: "600",
                    cursor: "pointer"
                  }}
                >
                  {t.back}
                </button>
              </div>
            </div>

            {/* Students Tab */}
            {isTeacher && (
              <div style={{
                background: "white",
                borderRadius: "12px",
                padding: "30px",
                marginBottom: "20px",
                boxShadow: "0 4px 15px rgba(0, 0, 0, 0.1)"
              }}>
                <div style={{
                  display: "flex",
                  justifyContent: "space-between",
                  alignItems: "center",
                  marginBottom: "20px"
                }}>
                  <h3 style={{
                    fontSize: "24px",
                    fontWeight: "700",
                    color: "#333",
                    margin: "0"
                  }}>
                    {t.students}
                  </h3>
                  <button 
                    onClick={() => navigateTo(`add-student-${classData.id}`)}
                    style={{
                      background: "linear-gradient(135deg, #4caf50, #66bb6a)",
                      color: "white",
                      border: "none",
                      padding: "10px 20px",
                      borderRadius: "8px",
                      fontSize: "16px",
                      fontWeight: "600",
                      cursor: "pointer"
                    }}
                  >
                    {t.addStudent}
                  </button>
                </div>

                {classData.students.length === 0 ? (
                  <div style={{
                    textAlign: "center",
                    padding: "40px",
                    color: "#666"
                  }}>
                    <div style={{
                      fontSize: "60px",
                      marginBottom: "15px"
                    }}>
                      👥
                    </div>
                    <p>No students added yet.</p>
                  </div>
                ) : (
                  <div style={{
                    overflowX: "auto"
                  }}>
                    <table style={{
                      width: "100%",
                      borderCollapse: "collapse"
                    }}>
                      <thead>
                        <tr style={{
                          backgroundColor: "#f5f5f5",
                          borderBottom: "2px solid #ddd"
                        }}>
                          <th style={{
                            padding: "12px",
                            textAlign: "left",
                            fontSize: "14px",
                            fontWeight: "600",
                            color: "#333"
                          }}>
                            {t.studentNameHeader}
                          </th>
                          <th style={{
                            padding: "12px",
                            textAlign: "left",
                            fontSize: "14px",
                            fontWeight: "600",
                            color: "#333"
                          }}>
                            Email
                          </th>
                          <th style={{
                            padding: "12px",
                            textAlign: "left",
                            fontSize: "14px",
                            fontWeight: "600",
                            color: "#333"
                          }}>
                            {t.joinedDate}
                          </th>
                          <th style={{
                            padding: "12px",
                            textAlign: "center",
                            fontSize: "14px",
                            fontWeight: "600",
                            color: "#333"
                          }}>
                            {t.actions}
                          </th>
                        </tr>
                      </thead>
                      <tbody>
                        {classData.students.map(student => (
                          <tr key={student.id} style={{
                            borderBottom: "1px solid #eee",
                            transition: "background-color 0.2s"
                          }}>
                            <td style={{
                              padding: "12px",
                              fontSize: "14px",
                              color: "#333"
                            }}>
                              {student.name}
                            </td>
                            <td style={{
                              padding: "12px",
                              fontSize: "14px",
                              color: "#666"
                            }}>
                              {student.email}
                            </td>
                            <td style={{
                              padding: "12px",
                              fontSize: "14px",
                              color: "#666"
                            }}>
                              {student.joinedDate}
                            </td>
                            <td style={{
                              padding: "12px",
                              textAlign: "center"
                            }}>
                              <button 
                                onClick={() => removeStudent(classData.id, student.id)}
                                style={{
                                  background: "#f44336",
                                  color: "white",
                                  border: "none",
                                  padding: "6px 12px",
                                  borderRadius: "6px",
                                  fontSize: "14px",
                                  fontWeight: "600",
                                  cursor: "pointer"
                                }}
                              >
                                {t.remove}
                              </button>
                            </td>
                          </tr>
                        ))}
                      </tbody>
                    </table>
                  </div>
                )}
              </div>
            )}

            {/* Materials Tab */}
            <div style={{
              background: "white",
              borderRadius: "12px",
              padding: "30px",
              marginBottom: "20px",
              boxShadow: "0 4px 15px rgba(0, 0, 0, 0.1)"
            }}>
              <div style={{
                display: "flex",
                justifyContent: "space-between",
                alignItems: "center",
                marginBottom: "20px"
              }}>
                <h3 style={{
                  fontSize: "24px",
                  fontWeight: "700",
                  color: "#333",
                  margin: "0"
                }}>
                  {t.materials}
                </h3>
                {isTeacher && (
                  <button 
                    onClick={() => navigateTo(`upload-material-${classData.id}`)}
                    style={{
                      background: "linear-gradient(135deg, #4caf50, #66bb6a)",
                      color: "white",
                      border: "none",
                      padding: "10px 20px",
                      borderRadius: "8px",
                      fontSize: "16px",
                      fontWeight: "600",
                      cursor: "pointer"
                    }}
                  >
                    {t.uploadMaterial}
                  </button>
                )}
              </div>

              {classData.materials.length === 0 ? (
                <div style={{
                  textAlign: "center",
                  padding: "40px",
                  color: "#666"
                }}>
                  <div style={{
                    fontSize: "60px",
                    marginBottom: "15px"
                  }}>
                    📎
                  </div>
                  <p>{t.noMaterials}</p>
                </div>
              ) : (
                <div style={{
                  spaceY: "15px"
                }}>
                  {classData.materials.map(material => (
                    <div key={material.id} style={{
                      display: "flex",
                      justifyContent: "space-between",
                      alignItems: "center",
                      padding: "15px",
                      border: "1px solid #eee",
                      borderRadius: "8px",
                      transition: "border-color 0.2s"
                    }}>
                      <div style={{
                        display: "flex",
                        alignItems: "center",
                        gap: "15px"
                      }}>
                        <div style={{
                          fontSize: "24px"
                        }}>
                          {material.type === "notes" && "📝"}
                          {material.type === "presentations" && "📊"}
                          {material.type === "worksheets" && "📄"}
                          {material.type === "videos" && "🎥"}
                          {material.type === "assignments" && "📋"}
                        </div>
                        <div>
                          <div style={{
                            fontWeight: "600",
                            color: "#333"
                          }}>
                            {material.name}
                          </div>
                          <div style={{
                            fontSize: "14px",
                            color: "#666"
                          }}>
                            {t.uploadedBy}: {material.uploadedBy} | {t.uploadDate}: {material.uploadDate}
                          </div>
                        </div>
                      </div>
                      <div style={{
                        display: "flex",
                        alignItems: "center",
                        gap: "10px"
                      }}>
                        <span style={{
                          fontSize: "14px",
                          color: "#666"
                        }}>
                          {material.type}
                        </span>
                        {isTeacher && (
                          <button 
                            onClick={() => removeMaterial(classData.id, material.id)}
                            style={{
                              background: "#f44336",
                              color: "white",
                              border: "none",
                              padding: "6px 12px",
                              borderRadius: "6px",
                              fontSize: "14px",
                              fontWeight: "600",
                              cursor: "pointer"
                            }}
                          >
                            {t.remove}
                          </button>
                        )}
                      </div>
                    </div>
                  ))}
                </div>
              )}
            </div>

            {/* Progress Tab */}
            {isTeacher && (
              <div style={{
                background: "white",
                borderRadius: "12px",
                padding: "30px",
                marginBottom: "20px",
                boxShadow: "0 4px 15px rgba(0, 0, 0, 0.1)"
              }}>
                <h3 style={{
                  fontSize: "24px",
                  fontWeight: "700",
                  color: "#333",
                  margin: "0 0 20px 0"
                }}>
                  {t.classProgress}
                </h3>

                {classData.students.length === 0 ? (
                  <div style={{
                    textAlign: "center",
                    padding: "40px",
                    color: "#666"
                  }}>
                    <div style={{
                      fontSize: "60px",
                      marginBottom: "15px"
                    }}>
                      📊
                    </div>
                    <p>No students to show progress.</p>
                  </div>
                ) : (
                  <div style={{
                    overflowX: "auto"
                  }}>
                    <table style={{
                      width: "100%",
                      borderCollapse: "collapse"
                    }}>
                      <thead>
                        <tr style={{
                          backgroundColor: "#f5f5f5",
                          borderBottom: "2px solid #ddd"
                        }}>
                          <th style={{
                            padding: "12px",
                            textAlign: "left",
                            fontSize: "14px",
                            fontWeight: "600",
                            color: "#333"
                          }}>
                            {t.studentNameHeader}
                          </th>
                          <th style={{
                            padding: "12px",
                            textAlign: "center",
                            fontSize: "14px",
                            fontWeight: "600",
                            color: "#333"
                          }}>
                            {t.completionRate}
                          </th>
                          <th style={{
                            padding: "12px",
                            textAlign: "center",
                            fontSize: "14px",
                            fontWeight: "600",
                            color: "#333"
                          }}>
                            {t.quizScore}
                          </th>
                          <th style={{
                            padding: "12px",
                            textAlign: "center",
                            fontSize: "14px",
                            fontWeight: "600",
                            color: "#333"
                          }}>
                            {t.assignmentScore}
                          </th>
                          <th style={{
                            padding: "12px",
                            textAlign: "center",
                            fontSize: "14px",
                            fontWeight: "600",
                            color: "#333"
                          }}>
                            {t.actions}
                          </th>
                        </tr>
                      </thead>
                      <tbody>
                        {classData.students.map(student => (
                          <tr key={student.id} style={{
                            borderBottom: "1px solid #eee",
                            transition: "background-color 0.2s"
                          }}>
                            <td style={{
                              padding: "12px",
                              fontSize: "14px",
                              color: "#333"
                            }}>
                              {student.name}
                            </td>
                            <td style={{
                              padding: "12px",
                              textAlign: "center",
                              fontSize: "14px",
                              color: "#333"
                            }}>
                              {student.progress?.completionRate || 0}%
                            </td>
                            <td style={{
                              padding: "12px",
                              textAlign: "center",
                              fontSize: "14px",
                              color: "#333"
                            }}>
                              {student.progress?.quizScore || 0}/100
                            </td>
                            <td style={{
                              padding: "12px",
                              textAlign: "center",
                              fontSize: "14px",
                              color: "#333"
                            }}>
                              {student.progress?.assignmentScore || 0}/100
                            </td>
                            <td style={{
                              padding: "12px",
                              textAlign: "center"
                            }}>
                              <button 
                                style={{
                                  background: "#2196f3",
                                  color: "white",
                                  border: "none",
                                  padding: "6px 12px",
                                  borderRadius: "6px",
                                  fontSize: "14px",
                                  fontWeight: "600",
                                  cursor: "pointer"
                                }}
                              >
                                {t.viewProgress}
                              </button>
                            </td>
                          </tr>
                        ))}
                      </tbody>
                    </table>
                  </div>
                )}
              </div>
            )}
          </div>
        );
      };

      // Add Student Page
      const AddStudentPage = () => {
        const classId = parseInt(currentPage.split('-')[2]);
        const classObj = teacherClasses.find(c => c.id === classId);
        
        if (!classObj) {
          navigateTo("teacher-dashboard");
          return null;
        }

        return (
          <div style={{
            maxWidth: "800px",
            margin: "0 auto",
            padding: "20px",
            fontFamily: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"
          }}>
            <div style={{
              background: "white",
              borderRadius: "12px",
              padding: "40px",
              marginBottom: "20px",
              boxShadow: "0 4px 15px rgba(0, 0, 0, 0.1)"
            }}>
              <h2 style={{
                fontSize: "28px",
                fontWeight: "700",
                color: "#333",
                marginBottom: "30px",
                textAlign: "center"
              }}>
                {t.addStudent}
              </h2>
              
              <form onSubmit={(e) => { e.preventDefault(); addStudent(); }} style={{
                spaceY: "20px"
              }}>
                <div style={{
                  marginBottom: "20px"
                }}>
                  <label style={{
                    display: "block",
                    fontSize: "14px",
                    fontWeight: "500",
                    color: "#333",
                    marginBottom: "8px"
                  }}>
                    {t.studentName}
                  </label>
                  <input 
                    type="text" 
                    value={studentForm.name} 
                    onChange={(e) => updateStudentForm("name", e.target.value)}
                    placeholder="Enter student's full name"
                    style={{
                      width: "100%",
                      border: "2px solid #ddd",
                      borderRadius: "8px",
                      padding: "12px",
                      fontSize: "16px"
                    }}
                    required
                  />
                </div>
                
                <div style={{
                  marginBottom: "20px"
                }}>
                  <label style={{
                    display: "block",
                    fontSize: "14px",
                    fontWeight: "500",
                    color: "#333",
                    marginBottom: "8px"
                  }}>
                    {t.studentEmail}
                  </label>
                  <input 
                    type="email" 
                    value={studentForm.email} 
                    onChange={(e) => updateStudentForm("email", e.target.value)}
                    placeholder="Enter student's email address"
                    style={{
                      width: "100%",
                      border: "2px solid #ddd",
                      borderRadius: "8px",
                      padding: "12px",
                      fontSize: "16px"
                    }}
                    required
                  />
                </div>
                
                <div style={{
                  marginBottom: "30px"
                }}>
                  <label style={{
                    display: "block",
                    fontSize: "14px",
                    fontWeight: "500",
                    color: "#333",
                    marginBottom: "8px"
                  }}>
                    {t.studentUsername}
                  </label>
                  <input 
                    type="text" 
                    value={studentForm.username} 
                    onChange={(e) => updateStudentForm("username", e.target.value)}
                    placeholder="Enter student's username"
                    style={{
                      width: "100%",
                      border: "2px solid #ddd",
                      borderRadius: "8px",
                      padding: "12px",
                      fontSize: "16px"
                    }}
                    required
                  />
                </div>
                
                <div style={{
                  display: "flex",
                  justifyContent: "center",
                  gap: "20px"
                }}>
                  <button 
                    type="button"
                    onClick={() => navigateTo(`class-details-${classId}`)}
                    style={{
                      background: "#9e9e9e",
                      color: "white",
                      border: "none",
                      padding: "12px 30px",
                      borderRadius: "8px",
                      fontSize: "16px",
                      fontWeight: "600",
                      cursor: "pointer"
                    }}
                  >
                    {t.cancel}
                  </button>
                  <button 
                    type="submit"
                    style={{
                      background: "linear-gradient(135deg, #4caf50, #66bb6a)",
                      color: "white",
                      border: "none",
                      padding: "12px 30px",
                      borderRadius: "8px",
                      fontSize: "16px",
                      fontWeight: "600",
                      cursor: "pointer"
                    }}
                  >
                    {t.addStudent}
                  </button>
                </div>
              </form>
            </div>
          </div>
        );
      };

      // Upload Material Page
      const UploadMaterialPage = () => {
        const classId = parseInt(currentPage.split('-')[2]);
        const classObj = teacherClasses.find(c => c.id === classId);
        
        if (!classObj) {
          navigateTo("teacher-dashboard");
          return null;
        }

        return (
          <div style={{
            maxWidth: "800px",
            margin: "0 auto",
            padding: "20px",
            fontFamily: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"
          }}>
            <div style={{
              background: "white",
              borderRadius: "12px",
              padding: "40px",
              marginBottom: "20px",
              boxShadow: "0 4px 15px rgba(0, 0, 0, 0.1)"
            }}>
              <h2 style={{
                fontSize: "28px",
                fontWeight: "700",
                color: "#333",
                marginBottom: "30px",
                textAlign: "center"
              }}>
                {t.uploadMaterial}
              </h2>
              
              <form onSubmit={(e) => { e.preventDefault(); addMaterial(); }} style={{
                spaceY: "20px"
              }}>
                <div style={{
                  marginBottom: "20px"
                }}>
                  <label style={{
                    display: "block",
                    fontSize: "14px",
                    fontWeight: "500",
                    color: "#333",
                    marginBottom: "8px"
                  }}>
                    {t.materialName}
                  </label>
                  <input 
                    type="text" 
                    value={materialForm.name} 
                    onChange={(e) => updateMaterialForm("name", e.target.value)}
                    placeholder="Enter material name"
                    style={{
                      width: "100%",
                      border: "2px solid #ddd",
                      borderRadius: "8px",
                      padding: "12px",
                      fontSize: "16px"
                    }}
                    required
                  />
                </div>
                
                <div style={{
                  marginBottom: "20px"
                }}>
                  <label style={{
                    display: "block",
                    fontSize: "14px",
                    fontWeight: "500",
                    color: "#333",
                    marginBottom: "8px"
                  }}>
                    {t.materialType}
                  </label>
                  <select 
                    value={materialForm.type} 
                    onChange={(e) => updateMaterialForm("type", e.target.value)}
                    style={{
                      width: "100%",
                      border: "2px solid #ddd",
                      borderRadius: "8px",
                      padding: "12px",
                      fontSize: "16px"
                    }}
                    required
                  >
                    <option value="notes">{t.notes}</option>
                    <option value="presentations">{t.presentations}</option>
                    <option value="worksheets">{t.worksheets}</option>
                    <option value="videos">{t.videos}</option>
                    <option value="assignments">{t.assignments}</option>
                  </select>
                </div>
                
                <div style={{
                  marginBottom: "30px"
                }}>
                  <label style={{
                    display: "block",
                    fontSize: "14px",
                    fontWeight: "500",
                    color: "#333",
                    marginBottom: "8px"
                  }}>
                    {t.file}
                  </label>
                  <div style={{
                    border: "2px dashed #ddd",
                    borderRadius: "8px",
                    padding: "20px",
                    textAlign: "center"
                  }}>
                    <input 
                      type="file" 
                      onChange={handleFileChange}
                      style={{
                        display: "none"
                      }}
                      id="file-upload"
                    />
                    <label htmlFor="file-upload" style={{
                      display: "inline-block",
                      background: "#4caf50",
                      color: "white",
                      border: "none",
                      padding: "10px 20px",
                      borderRadius: "8px",
                      fontSize: "16px",
                      fontWeight: "600",
                      cursor: "pointer"
                    }}>
                      {t.chooseFile}
                    </label>
                    {materialForm.file && (
                      <div style={{
                        marginTop: "10px",
                        fontSize: "14px",
                        color: "#666"
                      }}>
                        {t.file}: {materialForm.file.name}
                      </div>
                    )}
                  </div>
                </div>
                
                <div style={{
                  display: "flex",
                  justifyContent: "center",
                  gap: "20px"
                }}>
                  <button 
                    type="button"
                    onClick={() => navigateTo(`class-details-${classId}`)}
                    style={{
                      background: "#9e9e9e",
                      color: "white",
                      border: "none",
                      padding: "12px 30px",
                      borderRadius: "8px",
                      fontSize: "16px",
                      fontWeight: "600",
                      cursor: "pointer"
                    }}
                  >
                    {t.cancel}
                  </button>
                  <button 
                    type="submit"
                    style={{
                      background: "linear-gradient(135deg, #4caf50, #66bb6a)",
                      color: "white",
                      border: "none",
                      padding: "12px 30px",
                      borderRadius: "8px",
                      fontSize: "16px",
                      fontWeight: "600",
                      cursor: "pointer"
                    }}
                  >
                    {t.uploadFile}
                  </button>
                </div>
              </form>
            </div>
          </div>
        );
      };

      // Join Class Page
      const JoinClassPage = () => {
        return (
          <div style={{
            maxWidth: "800px",
            margin: "0 auto",
            padding: "20px",
            fontFamily: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"
          }}>
            <div style={{
              background: "white",
              borderRadius: "12px",
              padding: "40px",
              marginBottom: "20px",
              boxShadow: "0 4px 15px rgba(0, 0, 0, 0.1)"
            }}>
              <h2 style={{
                fontSize: "28px",
                fontWeight: "700",
                color: "#333",
                marginBottom: "30px",
                textAlign: "center"
              }}>
                {t.joinClass}
              </h2>
              
              <form onSubmit={(e) => { e.preventDefault(); joinClass(); }} style={{
                spaceY: "20px"
              }}>
                <div style={{
                  marginBottom: "30px"
                }}>
                  <label style={{
                    display: "block",
                    fontSize: "14px",
                    fontWeight: "500",
                    color: "#333",
                    marginBottom: "8px"
                  }}>
                    {t.enterClassCode}
                  </label>
                  <input 
                    type="text" 
                    value={joinClassCode} 
                    onChange={(e) => setJoinClassCode(e.target.value)}
                    placeholder="Enter class code"
                    style={{
                      width: "100%",
                      border: "2px solid #ddd",
                      borderRadius: "8px",
                      padding: "12px",
                      fontSize: "16px"
                    }}
                    required
                  />
                </div>
                
                <div style={{
                  display: "flex",
                  justifyContent: "center",
                  gap: "20px"
                }}>
                  <button 
                    type="button"
                    onClick={() => navigateTo("home")}
                    style={{
                      background: "#9e9e9e",
                      color: "white",
                      border: "none",
                      padding: "12px 30px",
                      borderRadius: "8px",
                      fontSize: "16px",
                      fontWeight: "600",
                      cursor: "pointer"
                    }}
                  >
                    {t.cancel}
                  </button>
                  <button 
                    type="submit"
                    style={{
                      background: "linear-gradient(135deg, #4caf50, #66bb6a)",
                      color: "white",
                      border: "none",
                      padding: "12px 30px",
                      borderRadius: "8px",
                      fontSize: "16px",
                      fontWeight: "600",
                      cursor: "pointer"
                    }}
                  >
                    {t.join}
                  </button>
                </div>
              </form>
            </div>
          </div>
        );
      };

      // Home Page
      const HomePage = () => {
        if (!user) {
          return <LoginPage />;
        }
        return (
          <div style={{
            maxWidth: "1200px",
            margin: "0 auto",
            padding: "20px",
            fontFamily: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"
          }}>
            {user.role === "student" ? <StudentDashboard /> : <TeacherDashboard />}
            <div style={{
              textAlign: "center",
              marginBottom: "40px"
            }}>
              <h1 style={{
                color: "#2e7d32",
                fontSize: "3.5rem",
                fontWeight: "700",
                margin: "0 0 10px 0",
                textShadow: "2px 2px 4px rgba(0, 0, 0, 0.1)"
              }}>
                {t.welcome}
              </h1>
              <p style={{
                fontSize: "1.2rem",
                color: "#333",
                maxWidth: "800px",
                margin: "0 auto"
              }}>
                {currentLanguage === "en" 
                  ? "Explore our resources to enhance your understanding of biology and track your progress."
                  : "探索我们的资源，加深您对生物学的理解并跟踪您的学习进度。"}
              </p>
            </div>
            <div style={{
              display: "flex",
              flexWrap: "wrap",
              gap: "20px",
              justifyContent: "center",
              marginTop: "40px"
            }}>
              {[
                { icon: "📚", title: t.library, description: currentLanguage === "en" ? "Access articles and videos tailored to your learning level" : "访问适合您学习水平的文章和视频", color: "#2196f3" },
                { icon: "✏️", title: t.exercises, description: currentLanguage === "en" ? "Practice exam-style questions and reinforce your knowledge" : "练习考试题型并巩固您的知识", color: "#4caf50" },
                { icon: "📋", title: t.assignments, description: currentLanguage === "en" ? "Complete teacher-assigned homework and tasks" : "完成老师布置的作业和任务", color: "#9c27b0" },
                { icon: "📊", title: t.progress, description: currentLanguage === "en" ? "Take quizzes to assess your understanding and monitor progress" : "参加测验来评估您的理解并监控进度", color: "#ff9800" }
              ].map((item, index) => (
                <div 
                  key={index}
                  onClick={() => navigateTo(item.title.toLowerCase())}
                  style={{
                    width: "250px",
                    height: "300px",
                    background: "white",
                    borderRadius: "12px",
                    boxShadow: "0 4px 15px rgba(0, 0, 0, 0.1)",
                    overflow: "hidden",
                    transition: "all 0.3s ease",
                    border: "none",
                    cursor: "pointer"
                  }}
                  onMouseEnter={(e) => {
                    e.currentTarget.style.transform = "translateY(-10px)";
                    e.currentTarget.style.boxShadow = "0 10px 25px rgba(0, 0, 0, 0.15)";
                  }}
                  onMouseLeave={(e) => {
                    e.currentTarget.style.transform = "translateY(0)";
                    e.currentTarget.style.boxShadow = "0 4px 15px rgba(0, 0, 0, 0.1)";
                  }}
                >
                  <div style={{
                    display: "flex",
                    justifyContent: "center",
                    alignItems: "center",
                    height: "100px",
                    marginBottom: "15px",
                    borderBottom: `4px solid ${item.color}`
                  }}>
                    <div style={{
                      fontSize: "60px"
                    }}>
                      {item.icon}
                    </div>
                  </div>
                  <div style={{
                    padding: "20px",
                    textAlign: "center"
                  }}>
                    <h3 style={{
                      fontSize: "1.3rem",
                      fontWeight: "700",
                      marginBottom: "10px",
                      color: "#333"
                    }}>
                      {item.title}
                    </h3>
                    <p style={{
                      fontSize: "0.9rem",
                      color: "#666",
                      margin: "0"
                    }}>
                      {item.description}
                    </p>
                  </div>
                </div>
              ))}
            </div>
          </div>
        );
      };

      // Admin Panel
      const AdminPanel = () => (
        <div style={{
          maxWidth: "1200px",
          margin: "0 auto",
          padding: "20px",
          fontFamily: "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"
        }}>
          {/* Header */}
          <div style={{
            background: "white",
            borderRadius: "12px",
            padding: "20px",
            marginBottom: "20px",
            boxShadow: "0 4px 15px rgba(0, 0, 0, 0.1)"
          }}>
            <div style={{
              display: "flex",
              alignItems: "center",
              justifyContent: "space-between"
            }}>
              <div>
                <h2 style={{
                  fontSize: "28px",
                  fontWeight: "700",
                  color: "#333",
                  margin: "0"
                }}>
                  🔐 {t.admin} Panel
                </h2>
                <p style={{
                  color: "#4caf50",
                  fontWeight: "600",
                  margin: "10px 0 0 0"
                }}>
                  {t.accessGranted}
                </p>
              </div>
              <button 
                onClick={handleLogout}
                style={{
                  background: "linear-gradient(135deg, #f44336, #ef5350)",
                  color: "white",
                  border: "none",
                  padding: "10px 20px",
                  borderRadius: "8px",
                  fontWeight: "600",
                  cursor: "pointer"
                }}
              >
                {t.logout}
              </button>
            </div>
          </div>

          {/* Admin Navigation Tabs */}
          <div style={{
            background: "white",
            borderRadius: "12px",
            padding: "10px",
            marginBottom: "20px",
            boxShadow: "0 4px 15px rgba(0, 0, 0, 0.1)"
          }}>
            <div style={{
              display: "flex",
              spaceX: "8px"
            }}>
              {[
                { id: "units", label: t.unitManagement, icon: "📚" },
                { id: "content", label: t.contentManagement, icon: "📄" },
                { id: "assignments", label: t.assignmentManagement, icon: "📋" },
                { id: "quizzes", label: t.quizManagement, icon: "📊" },
                { id: "users", label: t.userManagement, icon: "👥" }
              ].map(tab => (
                <button
                  key={tab.id}
                  onClick={() => navigateToAdminTab(tab.id)}
                  style={{
                    display: "flex",
                    alignItems: "center",
                    padding: "12px 20px",
                    borderRadius: "8px",
                    fontWeight: "600",
                    border: "none",
                    cursor: "pointer",
                    background: activeAdminTab === tab.id ? "#4caf50" : "transparent",
                    color: activeAdminTab === tab.id ? "white" : "#666"
                  }}
                >
                  <span style={{marginRight: "10px"}}>{tab.icon}</span>
                  {tab.label}
                </button>
              ))}
            </div>
          </div>

          {/* Units Management Tab */}
          {activeAdminTab === "units" && (
            <div style={{
              spaceY: "20px"
            }}>
              {/* Create New Unit Form */}
              <div style={{
                background: "white",
                borderRadius: "12px",
                padding: "30px",
                boxShadow: "0 4px 15px rgba(0, 0, 0, 0.1)"
              }}>
                <h3 style={{
                  fontSize: "24px",
                  fontWeight: "700",
                  color: "#333",
                  marginBottom: "20px",
                  display: "flex",
                  alignItems: "center"
                }}>
                  <span style={{marginRight: "10px"}}>➕</span>
                  {t.createUnit}
                </h3>
                <div style={{
                  display: "grid",
                  gridTemplateColumns: "1fr 1fr",
                  gap: "30px"
                }}>
                  <div style={{
                    spaceY: "20px"
                  }}>
                    <div>
                      <label style={{
                        display: "block",
                        fontSize: "14px",
                        fontWeight: "500",
                        color: "#333",
                        marginBottom: "8px"
                      }}>
                        {t.unitCode}
                      </label>
                      <input 
                        type="text" 
                        value={unitForm.unit} 
                        onChange={(e) => handleUnitChange("unit", e.target.value)}
                        placeholder={currentLanguage === "en" ? "e.g., Unit 3.1" : "例如：Unit 3.1"}
                        style={{
                          width: "100%",
                          border: "2px solid #ddd",
                          borderRadius: "8px",
                          padding: "12px",
                          fontSize: "16px"
                        }}
                      />
                    </div>
                    <div>
                      <label style={{
                        display: "block",
                        fontSize: "14px",
                        fontWeight: "500",
                        color: "#333",
                        marginBottom: "8px"
                      }}>
                        {t.unitTitle}
                      </label>
                      <input 
                        type="text" 
                        value={unitForm.title} 
                        onChange={(e) => handleUnitChange("title", e.target.value)}
                        placeholder={currentLanguage === "en" ? "e.g., Genetics and Inheritance" : "例如：遗传与继承"}
                        style={{
                          width: "100%",
                          border: "2px solid #ddd",
                          borderRadius: "8px",
                          padding: "12px",
                          fontSize: "16px"
                        }}
                      />
                    </div>
                  </div>
                  <div style={{
                    spaceY: "20px"
                  }}>
                    <div>
                      <label style={{
                        display: "block",
                        fontSize: "14px",
                        fontWeight: "500",
                        color: "#333",
                        marginBottom: "8px"
                      }}>
                        {t.description}
                      </label>
                      <textarea 
                        value={unitForm.description} 
                        onChange={(e) => handleUnitChange("description", e.target.value)}
                        rows="5"
                        placeholder={currentLanguage === "en" ? "Brief description of the unit..." : "单元的简要描述..."}
                        style={{
                          width: "100%",
                          border: "2px solid #ddd",
                          borderRadius: "8px",
                          padding: "12px",
                          fontSize: "16px"
                        }}
                      ></textarea>
                    </div>
                  </div>
                </div>
                <div style={{
                  marginTop: "30px",
                  display: "flex",
                  spaceX: "20px"
                }}>
                  <button 
                    onClick={saveUnit}
                    style={{
                      background: "linear-gradient(135deg, #4caf50, #66bb6a)",
                      color: "white",
                      border: "none",
                      padding: "12px 24px",
                      borderRadius: "8px",
                      fontSize: "16px",
                      fontWeight: "600",
                      cursor: "pointer"
                    }}
                  >
                    {t.save}
                  </button>
                  <button 
                    onClick={() => setUnitForm({unit: "", title: "", description: ""})}
                    style={{
                      background: "linear-gradient(135deg, #9e9e9e, #bdbdbd)",
                      color: "white",
                      border: "none",
                      padding: "12px 24px",
                      borderRadius: "8px",
                      fontSize: "16px",
                      fontWeight: "600",
                      cursor: "pointer"
                    }}
                  >
                    {t.cancel}
                  </button>
                </div>
              </div>

              {/* Units List */}
              <div style={{
                background: "white",
                borderRadius: "12px",
                padding: "30px",
                boxShadow: "0 4px 15px rgba(0, 0, 0, 0.1)"
              }}>
                <h3 style={{
                  fontSize: "24px",
                  fontWeight: "700",
                  color: "#333",
                  marginBottom: "20px"
                }}>
                  {t.units}
                </h3>
                <div style={{
                  spaceY: "20px"
                }}>
                  {content.map(unit => (
                    <div key={unit.unit} style={{
                      border: "2px solid #eee",
                      borderRadius: "12px",
                      padding: "20px",
                      transition: "border-color 0.3s ease"
                    }}>
                      <div style={{
                        display: "flex",
                        alignItems: "center",
                        justifyContent: "space-between",
                        marginBottom: "15px"
                      }}>
                        <div>
                          <h4 style={{
                            fontSize: "20px",
                            fontWeight: "700",
                            color: "#333",
                            margin: "0"
                          }}>
                            {unit.unit}
                          </h4>
                          <h5 style={{
                            fontSize: "18px",
                            fontWeight: "600",
                            color: "#333",
                            margin: "5px 0 0 0"
                          }}>
                            {unit.title}
                          </h5>
                          {unit.description && (
                            <p style={{
                              color: "#666",
                              margin: "10px 0 0 0"
                            }}>
                              {unit.description}
                            </p>
                          )}
                        </div>
                        <div style={{
                          display: "flex",
                          gap: "10px"
                        }}>
                          <button 
                            onClick={() => startEditUnit(unit)}
                            style={{
                              background: "#ff9800",
                              color: "white",
                              border: "none",
                              padding: "8px 16px",
                              borderRadius: "8px",
                              fontSize: "14px",
                              fontWeight: "600",
                              cursor: "pointer"
                            }}
                          >
                            {t.edit}
                          </button>
                          <button 
                            onClick={() => deleteUnit(unit.unit)}
                            style={{
                              background: "#f44336",
                              color: "white",
                              border: "none",
                              padding: "8px 16px",
                              borderRadius: "8px",
                              fontSize: "14px",
                              fontWeight: "600",
                              cursor: "pointer"
                            }}
                          >
                            {t.deleteUnit}
                          </button>
                        </div>
                      </div>
                      
                      <div style={{
                        display: "grid",
                        gridTemplateColumns: "1fr 1fr 1fr",
                        gap: "20px",
                        paddingTop: "15px",
                        borderTop: "1px solid #eee"
                      }}>
                        <div style={{
                          textAlign: "center",
                          padding: "15px",
                          background: "#e3f2fd",
                          borderRadius: "8px"
                        }}>
                          <div style={{
                            fontSize: "24px",
                            fontWeight: "700",
                            color: "#1976d2",
                            margin: "0"
                          }}>
                            {unit.articles.length}
                          </div>
                          <div style={{
                            fontSize: "14px",
                            color: "#1976d2",
                            fontWeight: "600",
                            margin: "5px 0 0 0"
                          }}>
                            {t.content}
                          </div>
                        </div>
                        <div style={{
                          textAlign: "center",
                          padding: "15px",
                          background: "#e8f5e8",
                          borderRadius: "8px"
                        }}>
                          <div style={{
                            fontSize: "24px",
                            fontWeight: "700",
                            color: "#388e3c",
                            margin: "0"
                          }}>
                            {unit.exercises.length}
                          </div>
                          <div style={{
                            fontSize: "14px",
                            color: "#388e3c",
                            fontWeight: "600",
                            margin: "5px 0 0 0"
                          }}>
                            {t.exercises}
                          </div>
                        </div>
                        <div style={{
                          textAlign: "center",
                          padding: "15px",
                          background: "#f3e5f5",
                          borderRadius: "8px"
                        }}>
                          <div style={{
                            fontSize: "24px",
                            fontWeight: "700",
                            color: "#7b1fa2",
                            margin: "0"
                          }}>
                            {unit.videos.length}
                          </div>
                          <div style={{
                            fontSize: "14px",
                            color: "#7b1fa2",
                            fontWeight: "600",
                            margin: "5px 0 0 0"
                          }}>
                            {t.videos}
                          </div>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            </div>
          )}

          {/* Content Management Tab */}
          {activeAdminTab === "content" && (
            <div style={{
              spaceY: "20px"
            }}>
              {/* Add Content Form */}
              {selectedUnit && !editingContent && (
                <div style={{
                  background: "white",
                  borderRadius: "12px",
                  padding: "30px",
                  boxShadow: "0 4px 15px rgba(0, 0, 0, 0.1)",
                  marginBottom: "20px"
                }}>
                <h3 style={{
                  fontSize: "24px",
                  fontWeight: "700",
                  color: "#333",
                  marginBottom: "20px"
                }}>
                  {editingContent ? t.update : t.add} {t.content}
                </h3>
                
                <div style={{
                  marginBottom: "20px"
                }}>
                  <label style={{
                    display: "block",
                    fontSize: "14px",
                    fontWeight: "500",
                    color: "#333",
                    marginBottom: "8px"
                  }}>
                    {t.unit}
                  </label>
                  <div style={{
                    padding: "12px",
                    border: "2px solid #ddd",
                    borderRadius: "8px",
                    fontSize: "16px"
                  }}>
                    {selectedUnit.unit} - {selectedUnit.title}
                  </div>
                </div>
                
                <div style={{
                  marginBottom: "20px"
                }}>
                  <label style={{
                    display: "block",
                    fontSize: "14px",
                    fontWeight: "500",
                    color: "#333",
                    marginBottom: "8px"
                  }}>
                    {t.type}
                  </label>
                  <select 
                    value={contentForm.type} 
                    onChange={(e) => setContentForm(prev => ({...prev, type: e.target.value}))}
                    style={{
                      width: "100%",
                      border: "2px solid #ddd",
                      borderRadius: "8px",
                      padding: "12px",
                      fontSize: "16px"
                    }}
                  >
                    <option value="article">{t.content}</option>
                    <option value="exercise">{t.exercises}</option>
                    <option value="video">{t.videos}</option>
                  </select>
                </div>
                
                <div style={{
                  marginBottom: "20px"
                }}>
                  <label style={{
                    display: "block",
                    fontSize: "14px",
                    fontWeight: "500",
                    color: "#333",
                    marginBottom: "8px"
                  }}>
                    {t.title}
                  </label>
                  <input 
                    type="text" 
                    value={contentForm.title} 
                    onChange={(e) => setContentForm(prev => ({...prev, title: e.target.value}))}
                    style={{
                      width: "100%",
                      border: "2px solid #ddd",
                      borderRadius: "8px",
                      padding: "12px",
                      fontSize: "16px"
                    }}
                    required
                  />
                </div>
                
                {contentForm.type === "article" && (
                  <div style={{
                    marginBottom: "20px"
                  }}>
                    <label style={{
                      display: "block",
                      fontSize: "14px",
                      fontWeight: "500",
                      color: "#333",
                      marginBottom: "8px"
                    }}>
                      {t.content}
                    </label>
                    <textarea 
                      value={contentForm.content} 
                      onChange={(e) => setContentForm(prev => ({...prev, content: e.target.value}))}
                      rows="6"
                      style={{
                        width: "100%",
                        border: "2px solid #ddd",
                        borderRadius: "8px",
                        padding: "12px",
                        fontSize: "16px"
                      }}
                    ></textarea>
                  </div>
                )}
                
                {contentForm.type === "video" && (
                  <>
                    <div style={{
                      marginBottom: "20px"
                    }}>
                      <label style={{
                        display: "block",
                        fontSize: "14px",
                        fontWeight: "500",
                        color: "#333",
                        marginBottom: "8px"
                      }}>
                        {t.url}
                      </label>
                      <input 
                        type="text" 
                        value={contentForm.url} 
                        onChange={(e) => setContentForm(prev => ({...prev, url: e.target.value}))}
                        placeholder="https://example.com/video"
                        style={{
                          width: "100%",
                          border: "2px solid #ddd",
                          borderRadius: "8px",
                          padding: "12px",
                          fontSize: "16px"
                        }}
                      />
                    </div>
                    
                    <div style={{
                      marginBottom: "20px"
                    }}>
                      <label style={{
                        display: "block",
                        fontSize: "14px",
                        fontWeight: "500",
                        color: "#333",
                        marginBottom: "8px"
                      }}>
                        {t.duration}
                      </label>
                      <input 
                        type="text" 
                        value={contentForm.duration} 
                        onChange={(e) => setContentForm(prev => ({...prev, duration: e.target.value}))}
                        placeholder="e.g., 5:30"
                        style={{
                          width: "100%",
                          border: "2px solid #ddd",
                          borderRadius: "8px",
                          padding: "12px",
                          fontSize: "16px"
                        }}
                      />
                    </div>
                    
                    <div style={{
                      marginBottom: "20px"
                    }}>
                      <label style={{
                        display: "block",
                        fontSize: "14px",
                        fontWeight: "500",
                        color: "#333",
                        marginBottom: "8px"
                      }}>
                        {t.description}
                      </label>
                      <textarea 
                        value={contentForm.description} 
                        onChange={(e) => setContentForm(prev => ({...prev, description: e.target.value}))}
                        rows="3"
                        style={{
                          width: "100%",
                          border: "2px solid #ddd",
                          borderRadius: "8px",
                          padding: "12px",
                          fontSize: "16px"
                        }}
                      ></textarea>
                    </div>
                  </>
                )}
                
                <div style={{
                  display: "flex",
                  justifyContent: "center",
                  gap: "20px"
                }}>
                  <button 
                    onClick={cancelAddContent}
                    style={{
                      background: "#9e9e9e",
                      color: "white",
                      border: "none",
                      padding: "12px 30px",
                      borderRadius: "8px",
                      fontSize: "16px",
                      fontWeight: "600",
                      cursor: "pointer"
                    }}
                  >
                    {t.cancel}
                  </button>
                  <button 
                    onClick={saveContent}
                    style={{
                      background: "linear-gradient(135deg, #4caf50, #66bb6a)",
                      color: "white",
                      border: "none",
                      padding: "12px 30px",
                      borderRadius: "8px",
                      fontSize: "16px",
                      fontWeight: "600",
                      cursor: "pointer"
                    }}
                  >
                    {editingContent ? t.update : t.add}
                  </button>
                </div>
              </div>
            )}

            {/* Units List for Content Selection */}
            {!selectedUnit && (
              <div style={{
                background: "white",
                borderRadius: "12px",
                padding: "30px",
                boxShadow: "0 4px 15px rgba(0, 0, 0, 0.1)"
              }}>
                <h3 style={{
                  fontSize: "24px",
                  fontWeight: "700",
                  color: "#333",
                  marginBottom: "20px"
                }}>
                  {t.selectUnit}
                </h3>
                <div style={{
                  spaceY: "20px"
                }}>
                  {content.map(unit => (
                    <div key={unit.unit} style={{
                      border: "2px solid #eee",
                      borderRadius: "12px",
                      padding: "20px",
                      transition: "border-color 0.3s ease"
                    }}>
                      <div style={{
                        display: "flex",
                        alignItems: "center",
                        justifyContent: "space-between",
                        marginBottom: "15px"
                      }}>
                        <div>
                          <h4 style={{
                            fontSize: "20px",
                            fontWeight: "700",
                            color: "#333",
                            margin: "0"
                          }}>
                            {unit.unit}
                          </h4>
                          <h5 style={{
                            fontSize: "18px",
                            fontWeight: "600",
                            color: "#333",
                            margin: "5px 0 0 0"
                          }}>
                            {unit.title}
                          </h5>
                        </div>
                        <button 
                          onClick={() => startAddContent(unit)}
                          style={{
                            background: "linear-gradient(135deg, #4caf50, #66bb6a)",
                            color: "white",
                            border: "none",
                            padding: "8px 16px",
                            borderRadius: "8px",
                            fontSize: "14px",
                            fontWeight: "600",
                            cursor: "pointer"
                          }}
                        >
                          {t.addContent}
                        </button>
                      </div>
                      
                      <div style={{
                        display: "grid",
                        gridTemplateColumns: "1fr 1fr 1fr",
                        gap: "20px",
                        paddingTop: "15px",
                        borderTop: "1px solid #eee"
                      }}>
                        <div style={{
                          textAlign: "center",
                          padding: "15px",
                          background: "#e3f2fd",
                          borderRadius: "8px"
                        }}>
                          <div style={{
                            fontSize: "24px",
                            fontWeight: "700",
                            color: "#1976d2",
                            margin: "0"
                          }}>
                            {unit.articles.length}
                          </div>
                          <div style={{
                            fontSize: "14px",
                            color: "#1976d2",
                            fontWeight: "600",
                            margin: "5px 0 0 0"
                          }}>
                            {t.articles}
                          </div>
                        </div>
                        <div style={{
                          textAlign: "center",
                          padding: "15px",
                          background: "#e8f5e8",
                          borderRadius: "8px"
                        }}>
                          <div style={{
                            fontSize: "24px",
                            fontWeight: "700",
                            color: "#388e3c",
                            margin: "0"
                          }}>
                            {unit.exercises.length}
                          </div>
                          <div style={{
                            fontSize: "14px",
                            color: "#388e3c",
                            fontWeight: "600",
                            margin: "5px 0 0 0"
                          }}>
                            {t.exercises}
                          </div>
                        </div>
                        <div style={{
                          textAlign: "center",
                          padding: "15px",
                          background: "#f3e5f5",
                          borderRadius: "8px"
                        }}>
                          <div style={{
                            fontSize: "24px",
                            fontWeight: "700",
                            color: "#7b1fa2",
                            margin: "0"
                          }}>
                            {unit.videos.length}
                          </div>
                          <div style={{
                            fontSize: "14px",
                            color: "#7b1fa2",
                            fontWeight: "600",
                            margin: "5px 0 0 0"
                          }}>
                            {t.videos}
                          </div>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            )}
          </div>
        )}
      </div>
    );

    return (
      <div style={{
        background: "#e8f5e8",
        minHeight: "100vh"
      }}>
        <Header />
        {currentPage === "home" && <HomePage />}
        {currentPage === "login" && <LoginPage />}
        {currentPage === "signup" && <SignupPage />}
        {currentPage === "admin" && isAuthenticated && <AdminPanel />}
        {currentPage.startsWith("create-class") && <CreateClassPage />}
        {currentPage.startsWith("edit-class") && <EditClassPage />}
        {currentPage.startsWith("class-details") && <ClassDetailsPage />}
        {currentPage.startsWith("add-student") && <AddStudentPage />}
        {currentPage.startsWith("upload-material") && <UploadMaterialPage />}
        {currentPage === "join-class" && <JoinClassPage />}
      </div>
    );
  }

  const container = document.getElementById('root');
  const root = ReactDOM.createRoot(container);
  root.render(<App />);
  </script>
</body>
</html>